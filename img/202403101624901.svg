<svg id="SvgjsSvg1006" width="5302.940221836532" height="3259.7777777777783" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><pattern patternUnits="userSpaceOnUse" id="pattern_mark_0" width="300" height="300"><text x="150" y="100" fill="rgba(229,229,229,0.8)" font-size="18" transform="rotate(-45, 150, 150)" style="dominant-baseline: middle; text-anchor: middle;"></text></pattern><pattern patternUnits="userSpaceOnUse" id="pattern_mark_1" width="300" height="300"><text x="150" y="200" fill="rgba(229,229,229,0.8)" font-size="18" transform="rotate(-45, 150, 150)" style="dominant-baseline: middle; text-anchor: middle;"></text></pattern><marker id="SvgjsMarker1045" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1046" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1082" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1083" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1092" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1093" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1102" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1103" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1116" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1117" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1164" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1165" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1174" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1175" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1184" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1185" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1222" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1223" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1238" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1239" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1248" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1249" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1266" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1267" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1282" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1283" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1404" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1405" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1418" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1419" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1448" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1449" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1462" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1463" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1483" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1484" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1508" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1509" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1516" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1517" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1545" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1546" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1549" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1550" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1577" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1578" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1585" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1586" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1616" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1617" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1666" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1667" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1694" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1695" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1708" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1709" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1722" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1723" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1736" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1737" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1756" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1757" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1806" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1807" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1810" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1811" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1814" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1815" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1826" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1827" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1836" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1837" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1865" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1866" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1882" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1883" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2062" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2063" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2084" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2085" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2103" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2104" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2114" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2115" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2125" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2126" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2251" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2252" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2259" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2260" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2267" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2268" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2271" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2272" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2387" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2388" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2391" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2392" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2395" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2396" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2403" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2404" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2411" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2412" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2419" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2420" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2446" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2447" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2490" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2491" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2653" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2654" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2667" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2668" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2689" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2690" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2693" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2694" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2701" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2702" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2709" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2710" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2735" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2736" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2749" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2750" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2759" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2760" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2885" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2886" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2900" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2901" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2914" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2915" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2937" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2938" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2948" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2949" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2958" markerWidth="13" markerHeight="9" refX="9.5" refY="4.5" viewBox="0 0 13 9" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2959" d="M0,0 L13,4.5 L0,9 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker></defs><rect id="svgbackgroundid" width="5302.940221836532" height="3259.7777777777783" fill="transparent"></rect><rect id="SvgjsRect1009" width="5302.940221836532" height="3259.7777777777783" fill="url(#pattern_mark_0)"></rect><rect id="SvgjsRect1010" width="5302.940221836532" height="3259.7777777777783" fill="url(#pattern_mark_1)"></rect><g id="SvgjsG1011" transform="translate(3605.0738025415426,346.2672511351989)"><path id="SvgjsPath1012" d="M 0 0L 1672.86641929499 0L 1672.86641929499 1385.1102302716452L 0 1385.1102302716452Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#fbe9d0"></path><g id="SvgjsG1013"><text id="SvgjsText1014" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1653px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="681.9301151358226" transform="rotate(0)"></text></g></g><g id="SvgjsG1015" transform="translate(934.8888888888889,514.6274509803918)"><path id="SvgjsPath1016" d="M 0 0L 1200.111111111111 0L 1200.111111111111 2720.1503267973862L 0 2720.1503267973862Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#fbe9d0"></path><g id="SvgjsG1017"><text id="SvgjsText1018" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1181px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1349.4501633986931" transform="rotate(0)"></text></g></g><g id="SvgjsG1019" transform="translate(25,25)"><path id="SvgjsPath1020" d="M 0 0L 325 0L 341 16L 341 100L 0 100L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath1021" d="M 325 0L 325 16L 341 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath1022" d="M 0 0L 325 0L 341 16L 341 100L 0 100L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1023"><text id="SvgjsText1024" font-family="微软雅黑" text-anchor="start" font-size="13px" width="321px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1025" dy="16.25" x="10"><tspan id="SvgjsTspan1026" style="">整个ReentrantLock的加锁过程，可以分为三个阶段：</tspan></tspan><tspan id="SvgjsTspan1027" dy="16.25" x="10"><tspan id="SvgjsTspan1028" style="">1. 尝试加锁</tspan></tspan><tspan id="SvgjsTspan1029" dy="16.25" x="10"><tspan id="SvgjsTspan1030" style="">2. 加锁失败，线程进入队列</tspan></tspan><tspan id="SvgjsTspan1031" dy="16.25" x="10"><tspan id="SvgjsTspan1032" style="">3. 线程进入队列后，进入阻塞状态</tspan></tspan><tspan id="SvgjsTspan1033" dy="16.25" x="10"><tspan id="SvgjsTspan1034" style=""> </tspan></tspan><tspan id="SvgjsTspan1035" dy="16.25" x="10"><tspan id="SvgjsTspan1036" style="">对应下面 ① ② ③ 三部分</tspan></tspan></text></g></g><g id="SvgjsG1037" transform="translate(2790.666666666667,178.33333333333337)"><path id="SvgjsPath1038" d="M 16.666666666666668 0L 98.33333333333333 0C 120.55555555555556 0 120.55555555555556 50 98.33333333333333 50L 16.666666666666668 50C -5.555555555555556 50 -5.555555555555556 0 16.666666666666668 0Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1039"><text id="SvgjsText1040" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="95px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="14.375" transform="rotate(0)"><tspan id="SvgjsTspan1041" dy="16.25" x="57.5"><tspan id="SvgjsTspan1042" style="">ReentrantLock</tspan></tspan></text></g></g><g id="SvgjsG1043"><path id="SvgjsPath1044" d="M2848.166666666667 229.08333333333337L2848.166666666667 248.33333333333337L2848.166666666667 248.33333333333337L2848.166666666667 265.6333333333334" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1045)"></path></g><g id="SvgjsG1047" transform="translate(2809.666666666667,268.33333333333337)"><path id="SvgjsPath1048" d="M 0 4Q 0 0 4 0L 73 0Q 77 0 77 4L 77 28Q 77 32 73 32L 4 32Q 0 32 0 28Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1049"><text id="SvgjsText1050" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="57px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="5.375" transform="rotate(0)"><tspan id="SvgjsTspan1051" dy="16.25" x="38.5"><tspan id="SvgjsTspan1052" style="">lock</tspan></tspan></text></g></g><g id="SvgjsG1053"><path id="SvgjsPath1054" d="M2887.416666666667 284.33333333333337L2919.9848484848485 284.33333333333337L2919.9848484848485 284.33333333333337L2952.55303030303 284.33333333333337" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1055" transform="translate(2953.30303030303,254.4242424242425)"><path id="SvgjsPath1056" d="M 0 0L 149.09090909090924 0L 149.09090909090924 59.81818181818181L 0 59.81818181818181Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1057"><text id="SvgjsText1058" font-family="微软雅黑" text-anchor="start" font-size="13px" width="130px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="2.7840909090909065" transform="rotate(0)"><tspan id="SvgjsTspan1059" dy="16.25" x="10"><tspan id="SvgjsTspan1060" style="font-weight: bold;fill: rgb(91, 121, 232);">public void</tspan><tspan id="SvgjsTspan1061" style=""> lock() {</tspan></tspan><tspan id="SvgjsTspan1062" dy="16.25" x="10"><tspan id="SvgjsTspan1063" style="">    </tspan><tspan id="SvgjsTspan1064" style="fill: rgb(91, 121, 232);">sync</tspan><tspan id="SvgjsTspan1065" style="">.lock();</tspan></tspan><tspan id="SvgjsTspan1066" dy="16.25" x="10"><tspan id="SvgjsTspan1067" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1068"><path id="SvgjsPath1069" d="M3103.14393939394 284.33333333333337L3135.7121212121215 284.33333333333337L3135.7121212121215 284.33333333333337L3169.030303030303 284.33333333333337" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1070" transform="translate(3169.030303030303,255.74242424242425)"><path id="SvgjsPath1071" d="M 0 0L 271.27272727272725 0L 287.27272727272725 16L 287.27272727272725 57.18181818181819L 0 57.18181818181819L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath1072" d="M 271.27272727272725 0L 271.27272727272725 16L 287.27272727272725 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath1073" d="M 0 0L 271.27272727272725 0L 287.27272727272725 16L 287.27272727272725 57.18181818181819L 0 57.18181818181819L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1074"><text id="SvgjsText1075" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="268px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.965909090909093" transform="rotate(0)"><tspan id="SvgjsTspan1076" dy="16.25" x="144"><tspan id="SvgjsTspan1077" style="font-weight: bold;font-style: italic;fill: rgb(91, 121, 232);">Sync</tspan><tspan id="SvgjsTspan1078" style=""> 继承自 </tspan><tspan id="SvgjsTspan1079" style="font-weight: bold;font-style: italic;fill: rgb(91, 121, 232);">AbstractQueuedSynchronizer</tspan></tspan></text></g></g><g id="SvgjsG1080"><path id="SvgjsPath1081" d="M2848.166666666667 301.08333333333337L2848.166666666667 320.33333333333337L2848.166666666667 320.33333333333337L2848.166666666667 337.6333333333334" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1082)"></path></g><g id="SvgjsG1084" transform="translate(2800.166666666667,340.33333333333337)"><path id="SvgjsPath1085" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1086"><text id="SvgjsText1087" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1088" dy="16.25" x="48"><tspan id="SvgjsTspan1089" style="">sync.lock()</tspan></tspan></text></g></g><g id="SvgjsG1090"><path id="SvgjsPath1091" d="M2848.166666666667 395.08333333333337L2848.166666666667 414.33333333333337L2848.166666666667 414.33333333333337L2848.166666666667 431.6333333333334" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1092)"></path></g><g id="SvgjsG1094" transform="translate(2773.280303030303,434.33333333333337)"><path id="SvgjsPath1095" d="M 0 35L 74.88636363636363 0L 149.77272727272725 35L 74.88636363636363 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1096"><text id="SvgjsText1097" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="130px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1098" dy="16.25" x="75"><tspan id="SvgjsTspan1099" style="font-style: italic;">abstract void lock()</tspan></tspan></text></g></g><g id="SvgjsG1100"><path id="SvgjsPath1101" d="M2772.530303030303 469.33333333333337L2741.166666666667 469.33333333333337L2741.166666666667 522.6333333333333" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1102)"></path><rect id="SvgjsRect1104" width="39" height="16" x="2721.666666666667" y="482.31396737558737" fill="#ffffff"></rect><text id="SvgjsText1105" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="39px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="479.68896737558737" transform="rotate(0)"><tspan id="SvgjsTspan1106" dy="16.25" x="2741.166666666667"><tspan id="SvgjsTspan1107" style="">公平锁</tspan></tspan></text></g><g id="SvgjsG1108" transform="translate(2682.166666666667,525.3333333333333)"><path id="SvgjsPath1109" d="M 0 4Q 0 0 4 0L 114 0Q 118 0 118 4L 118 50Q 118 54 114 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1110"><text id="SvgjsText1111" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="98px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1112" dy="16.25" x="59"><tspan id="SvgjsTspan1113" style="">FairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1114"><path id="SvgjsPath1115" d="M2923.80303030303 469.33333333333337L2967.89393939394 469.33333333333337L2967.89393939394 522.6333333333333" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1116)"></path><rect id="SvgjsRect1118" width="52" height="16" x="2941.89393939394" y="481.26975843628964" fill="#ffffff"></rect><text id="SvgjsText1119" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="52px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="478.64475843628964" transform="rotate(0)"><tspan id="SvgjsTspan1120" dy="16.25" x="2967.89393939394"><tspan id="SvgjsTspan1121" style="">非公平锁</tspan></tspan></text></g><g id="SvgjsG1122" transform="translate(2896.166666666667,525.3333333333333)"><path id="SvgjsPath1123" d="M 0 0L 143.4545454545455 0L 143.4545454545455 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1124"><text id="SvgjsText1125" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="124px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1126" dy="16.25" x="72"><tspan id="SvgjsTspan1127" style="">NonFairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1128"><path id="SvgjsPath1129" d="M3040.3434915172074 552.1313123588766C 3078.174530358524 552.3333333333333 3057.749712065718 474.3787878787879 3095.5807509070346 474.5808088532446" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1130" transform="translate(3096.30303030303,411.33333333333337)"><path id="SvgjsPath1131" d="M 0 0L 367.27272727272725 0L 367.27272727272725 126.09090909090907L 0 126.09090909090907Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1132"><text id="SvgjsText1133" font-family="微软雅黑" text-anchor="start" font-size="13px" width="348px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="11.420454545454533" transform="rotate(0)"><tspan id="SvgjsTspan1134" dy="16.25" x="10"><tspan id="SvgjsTspan1135" style="">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1136" dy="16.25" x="10"><tspan id="SvgjsTspan1137" style="">    if (compareAndSetState(0, 1))</tspan></tspan><tspan id="SvgjsTspan1138" dy="16.25" x="10"><tspan id="SvgjsTspan1139" style="">        setExclusiveOwnerThread(Thread.currentThread());</tspan></tspan><tspan id="SvgjsTspan1140" dy="16.25" x="10"><tspan id="SvgjsTspan1141" style="">    else</tspan></tspan><tspan id="SvgjsTspan1142" dy="16.25" x="10"><tspan id="SvgjsTspan1143" style="">        acquire(1);</tspan></tspan><tspan id="SvgjsTspan1144" dy="16.25" x="10"><tspan id="SvgjsTspan1145" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1146"><path id="SvgjsPath1147" d="M2681.430215560262 552.191418683369C 2636.0236156511046 552.3333333333333 2646.1733540458654 471.3333333333334 2600.766754136708 471.4752479832977" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1148" transform="translate(1012.189108939303,651.4444444444446)"><path id="SvgjsPath1149" d="M 0 0L 1083.8392046790345 0L 1083.8392046790345 1327.7777777777778L 0 1327.7777777777778Z" stroke-dasharray="10,6,3,6" stroke="rgba(121,133,236,1)" stroke-width="1.5" fill-opacity="1" fill="#d2d6f9"></path><g id="SvgjsG1150"><text id="SvgjsText1151" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1064px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="653.2638888888889" transform="rotate(0)"></text></g></g><g id="SvgjsG1152" transform="translate(2461.848484848485,447.33333333333337)"><path id="SvgjsPath1153" d="M 0 0L 138.1818181818182 0L 138.1818181818182 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1154"><text id="SvgjsText1155" font-family="微软雅黑" text-anchor="start" font-size="13px" width="119px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="-0.125" transform="rotate(0)"><tspan id="SvgjsTspan1156" dy="16.25" x="10"><tspan id="SvgjsTspan1157" style="">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1158" dy="16.25" x="10"><tspan id="SvgjsTspan1159" style="">    acquire(1);</tspan></tspan><tspan id="SvgjsTspan1160" dy="16.25" x="10"><tspan id="SvgjsTspan1161" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1162"><path id="SvgjsPath1163" d="M2741.166666666667 580.0833333333334C 2741.166666666667 610.460606060606 2741.166666666667 626.0242424242425 2741.166666666667 654.4515151515151" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1164)"></path></g><g id="SvgjsG1166" transform="translate(2693.166666666667,657.1515151515151)"><path id="SvgjsPath1167" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#95da69"></path><g id="SvgjsG1168"><text id="SvgjsText1169" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1170" dy="16.25" x="48"><tspan id="SvgjsTspan1171" style="">acquire(1)</tspan></tspan></text></g></g><g id="SvgjsG1172"><path id="SvgjsPath1173" d="M2967.89393939394 580.0833333333334L2967.89393939394 646.4515151515151" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1174)"></path></g><g id="SvgjsG1176" transform="translate(2919.893939393939,649.1515151515151)"><path id="SvgjsPath1177" d="M 0 35L 48 0L 96 35L 48 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1178"><text id="SvgjsText1179" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1180" dy="16.25" x="48"><tspan id="SvgjsTspan1181" style="">CAS获取锁</tspan></tspan></text></g></g><g id="SvgjsG1182"><path id="SvgjsPath1183" d="M2919.143939393939 684.1515151515151L2791.866666666667 684.1515151515151" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1184)"></path><rect id="SvgjsRect1186" width="29" height="16" x="2849.812040607746" y="676.151515151515" fill="#ffffff"></rect><text id="SvgjsText1187" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="673.526515151515" transform="rotate(0)"><tspan id="SvgjsTspan1188" dy="16.25" x="2864.312040607746"><tspan id="SvgjsTspan1189" style="">false</tspan></tspan></text></g><g id="SvgjsG1190"><path id="SvgjsPath1191" d="M2692.4207254027706 684.0735944814929C 2643.8563086781196 684.1515151515151 2631.0679337461233 631.3787878787879 2582.5035170214724 631.4567085488101" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1192" transform="translate(2210.848484848485,569.2424242424242)"><path id="SvgjsPath1193" d="M 0 0L 370.9090909090909 0L 370.9090909090909 124.2727272727272L 0 124.2727272727272Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1194"><text id="SvgjsText1195" font-family="微软雅黑" text-anchor="start" font-size="13px" width="351px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="10.511363636363598" transform="rotate(0)"><tspan id="SvgjsTspan1196" dy="16.25" x="10"><tspan id="SvgjsTspan1197" style="">public final void acquire(int arg) {</tspan></tspan><tspan id="SvgjsTspan1198" dy="16.25" x="10"><tspan id="SvgjsTspan1199" style="">    if (!tryAcquire(arg) &amp;&amp;</tspan></tspan><tspan id="SvgjsTspan1200" dy="16.25" x="10"><tspan id="SvgjsTspan1201" style="">            acquireQueued(addWaiter(Node.EXCLUSIVE), ar</tspan></tspan><tspan id="SvgjsTspan1202" dy="16.25" x="10"><tspan id="SvgjsTspan1203" style="">g))</tspan></tspan><tspan id="SvgjsTspan1204" dy="16.25" x="10"><tspan id="SvgjsTspan1205" style="">        selfInterrupt();</tspan></tspan><tspan id="SvgjsTspan1206" dy="16.25" x="10"><tspan id="SvgjsTspan1207" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1208"><path id="SvgjsPath1209" d="M2396.1515348045573 568.50788417276C 2396.3030303030305 511.81071344639554 2268.325757575758 561.5832259475437 2268.325757575758 504.1515151515152" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1210" transform="translate(2185.3939393939395,444.5151515151515)"><path id="SvgjsPath1211" d="M 0 0L 149.86363636363637 0L 165.86363636363637 16L 165.86363636363637 59.63636363636368L 0 59.63636363636368L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath1212" d="M 149.86363636363637 0L 149.86363636363637 16L 165.86363636363637 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath1213" d="M 0 0L 149.86363636363637 0L 165.86363636363637 16L 165.86363636363637 59.63636363636368L 0 59.63636363636368L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1214"><text id="SvgjsText1215" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="146px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.693181818181841" transform="rotate(0)"><tspan id="SvgjsTspan1216" dy="16.25" x="83"><tspan id="SvgjsTspan1217" style="">尝试获取锁，如果获取不</tspan></tspan><tspan id="SvgjsTspan1218" dy="16.25" x="83"><tspan id="SvgjsTspan1219" style="">到，排队(阻塞当前线程)</tspan></tspan></text></g></g><g id="SvgjsG1220"><path id="SvgjsPath1221" d="M3016.643939393939 684.1515151515151L3146.166666666667 684.1515151515151L3146.166666666667 769.3000000000001" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1222)"></path><rect id="SvgjsRect1224" width="24" height="16" x="3061.5162091742477" y="676.1515151515151" fill="#ffffff"></rect><text id="SvgjsText1225" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="673.5265151515151" transform="rotate(0)"><tspan id="SvgjsTspan1226" dy="16.25" x="3073.5162091742477"><tspan id="SvgjsTspan1227" style="">true</tspan></tspan></text></g><g id="SvgjsG1228" transform="translate(3059.666666666667,772.0000000000001)"><path id="SvgjsPath1229" d="M 0 0L 173 0L 173 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f6edc1"></path><g id="SvgjsG1230"><text id="SvgjsText1231" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="153px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1232" dy="16.25" x="86.5"><tspan id="SvgjsTspan1233" style="">成功获取到锁，设置锁持</tspan></tspan><tspan id="SvgjsTspan1234" dy="16.25" x="86.5"><tspan id="SvgjsTspan1235" style="">有线程为当前线程，返回</tspan></tspan></text></g></g><g id="SvgjsG1236"><path id="SvgjsPath1237" d="M2741.166666666667 711.9015151515151L2741.166666666667 760.7424242424244L2741.166666666667 760.7424242424244L2741.166666666667 807.6333333333336" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1238)"></path></g><g id="SvgjsG1240" transform="translate(2682.083333333333,810.3333333333336)"><path id="SvgjsPath1241" d="M 0 35L 59.083333333333314 0L 118.16666666666663 35L 59.083333333333314 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1242"><text id="SvgjsText1243" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="99px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1244" dy="16.25" x="59.5"><tspan id="SvgjsTspan1245" style="">tryAcquire(arg)</tspan></tspan></text></g></g><g id="SvgjsG1246"><path id="SvgjsPath1247" d="M2681.333333333333 845.3333333333336L2594.166666666667 845.3333333333336L2594.166666666667 914.3000000000001" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1248)"></path><rect id="SvgjsRect1250" width="24" height="16" x="2582.166666666667" y="870.2842282514096" fill="#ffffff"></rect><text id="SvgjsText1251" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="867.6592282514096" transform="rotate(0)"><tspan id="SvgjsTspan1252" dy="16.25" x="2594.166666666667"><tspan id="SvgjsTspan1253" style="">true</tspan></tspan></text></g><g id="SvgjsG1254" transform="translate(2522.666666666667,917.0000000000001)"><path id="SvgjsPath1255" d="M 0 0L 143 0L 143 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f6edc1"></path><g id="SvgjsG1256"><text id="SvgjsText1257" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="123px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.125" transform="rotate(0)"><tspan id="SvgjsTspan1258" dy="16.25" x="71.5"><tspan id="SvgjsTspan1259" style="">返回 true，表示获取</tspan></tspan><tspan id="SvgjsTspan1260" dy="16.25" x="71.5"><tspan id="SvgjsTspan1261" style="">到锁了，线程逐级返</tspan></tspan><tspan id="SvgjsTspan1262" dy="16.25" x="71.5"><tspan id="SvgjsTspan1263" style="">回，加锁过程结束</tspan></tspan></text></g></g><g id="SvgjsG1264"><path id="SvgjsPath1265" d="M2801 845.3333333333336L2884.4651492433813 845.3333333333336L2884.4651492433813 914.3000000000001" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1266)"></path><rect id="SvgjsRect1268" width="29" height="16" x="2869.9651492433813" y="870.3031255850291" fill="#ffffff"></rect><text id="SvgjsText1269" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="867.6781255850291" transform="rotate(0)"><tspan id="SvgjsTspan1270" dy="16.25" x="2884.4651492433813"><tspan id="SvgjsTspan1271" style="">false</tspan></tspan></text></g><g id="SvgjsG1272" transform="translate(2818.719696969697,917.0000000000001)"><path id="SvgjsPath1273" d="M 0 0L 128.94696969696975 0L 128.94696969696975 54L 0 54Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f8f531"></path><g id="SvgjsG1274"><text id="SvgjsText1275" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="109px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1276" dy="16.25" x="64.5"><tspan id="SvgjsTspan1277" style="">返回 false，表示</tspan></tspan><tspan id="SvgjsTspan1278" dy="16.25" x="64.5"><tspan id="SvgjsTspan1279" style="">线程没有获取到锁</tspan></tspan></text></g></g><g id="SvgjsG1280"><path id="SvgjsPath1281" d="M2883.193181818182 971.7500000000001L2883.193181818182 1014.8333333333335L2883.193181818182 1014.8333333333335L2883.193181818182 1055.9666666666667" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1282)"></path></g><g id="SvgjsG1284" transform="translate(2800.289772727273,1058.6666666666667)"><path id="SvgjsPath1285" d="M 0 4Q 0 0 4 0L 161.80681818181824 0Q 165.80681818181824 0 165.80681818181824 4L 165.80681818181824 50Q 165.80681818181824 54 161.80681818181824 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1286"><text id="SvgjsText1287" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="146px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1288" dy="16.25" x="83"><tspan id="SvgjsTspan1289" style="">addWaiter(Node mode)</tspan></tspan></text></g></g><g id="SvgjsG1290"><path id="SvgjsPath1291" d="M2715.4774752009985 825.604353793883C 2570.8844878021728 584.9276962822867 2294.0531141317356 851.5678000313849 2013.2821634267405 851.5558858504778" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect1292" width="65" height="16" x="2353.3010785136885" y="749.6223215190241" fill="#ffffff"></rect><text id="SvgjsText1293" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="65px" fill="#a7932c" font-weight="700" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="700" font-style="" opacity="1" y="746.9973215190241" transform="rotate(0)"><tspan id="SvgjsTspan1294" dy="16.25" x="2385.8010785136885"><tspan id="SvgjsTspan1295" style="">尝试获取锁</tspan></tspan></text></g><g id="SvgjsG1296" transform="translate(940.7286473696075,515.9290637678992)"><path id="SvgjsPath1297" d="M 0 0L 373.0536106949087 0L 373.0536106949087 72.8085391308681L 0 72.8085391308681Z" stroke="none" fill="none"></path><g id="SvgjsG1298"><text id="SvgjsText1299" font-family="微软雅黑" text-anchor="start" font-size="13px" width="374px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.27926956543405" transform="rotate(0)"><tspan id="SvgjsTspan1300" dy="16.25" x="0"><tspan id="SvgjsTspan1301" style="">这部分所有逻辑，都是 </tspan><tspan id="SvgjsTspan1302" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1303" style=""> 方法调用引申出来的</tspan></tspan><tspan id="SvgjsTspan1304" dy="16.25" x="0"><tspan id="SvgjsTspan1305" style=""> </tspan></tspan><tspan id="SvgjsTspan1306" dy="16.25" x="0"><tspan id="SvgjsTspan1307" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1308" style=""> 方法，顾名思义，就是尝试获取一次锁</tspan></tspan></text></g></g><g id="SvgjsG1309" transform="translate(945.2746002790701,569.2424242424242)"><path id="SvgjsPath1310" d="M 0 0L 54.813593845055486 0L 54.813593845055486 95.02216668634723L 0 95.02216668634723Z" stroke="none" fill="none"></path><g id="SvgjsG1311"><text id="SvgjsText1312" font-family="微软雅黑" text-anchor="middle" font-size="60px" width="55px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="60px" weight="400" font-style="" opacity="1" y="-2.488916656826383" transform="rotate(0)"><tspan id="SvgjsTspan1313" dy="75" x="27.5"><tspan id="SvgjsTspan1314" style="font-weight: bold;">①</tspan></tspan></text></g></g><g id="SvgjsG1315" transform="translate(1642.7405913978496,675.9428000313851)"><path id="SvgjsPath1316" d="M 0 0L 369.79166666666663 0L 369.79166666666663 351.25L 0 351.25Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1317"><text id="SvgjsText1318" font-family="微软雅黑" text-anchor="start" font-size="13px" width="350px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="10.5" transform="rotate(0)"><tspan id="SvgjsTspan1319" dy="16.25" x="10"><tspan id="SvgjsTspan1320" style="">protected final boolean tryAcquire(int acquires) {</tspan></tspan><tspan id="SvgjsTspan1321" dy="16.25" x="10"><tspan id="SvgjsTspan1322" style="">    final Thread current = Thread.currentThread();</tspan></tspan><tspan id="SvgjsTspan1323" dy="16.25" x="10"><tspan id="SvgjsTspan1324" style="">    int c = getState();</tspan></tspan><tspan id="SvgjsTspan1325" dy="16.25" x="10"><tspan id="SvgjsTspan1326" style="">    if (c == 0) {</tspan></tspan><tspan id="SvgjsTspan1327" dy="16.25" x="10"><tspan id="SvgjsTspan1328" style="">        if (!hasQueuedPredecessors() &amp;&amp;</tspan></tspan><tspan id="SvgjsTspan1329" dy="16.25" x="10"><tspan id="SvgjsTspan1330" style="">                compareAndSetState(0, acquires)) {</tspan></tspan><tspan id="SvgjsTspan1331" dy="16.25" x="10"><tspan id="SvgjsTspan1332" style="">            setExclusiveOwnerThread(current);</tspan></tspan><tspan id="SvgjsTspan1333" dy="16.25" x="10"><tspan id="SvgjsTspan1334" style="">            return true;</tspan></tspan><tspan id="SvgjsTspan1335" dy="16.25" x="10"><tspan id="SvgjsTspan1336" style="">        }</tspan></tspan><tspan id="SvgjsTspan1337" dy="16.25" x="10"><tspan id="SvgjsTspan1338" style="">    }</tspan></tspan><tspan id="SvgjsTspan1339" dy="16.25" x="10"><tspan id="SvgjsTspan1340" style="">    else if (current == getExclusiveOwnerThread()) {</tspan></tspan><tspan id="SvgjsTspan1341" dy="16.25" x="10"><tspan id="SvgjsTspan1342" style="">        int nextc = c + acquires;</tspan></tspan><tspan id="SvgjsTspan1343" dy="16.25" x="10"><tspan id="SvgjsTspan1344" style="">        if (nextc &lt; 0)</tspan></tspan><tspan id="SvgjsTspan1345" dy="16.25" x="10"><tspan id="SvgjsTspan1346" style="">            throw new Error("Maximum lock count exceeded</tspan></tspan><tspan id="SvgjsTspan1347" dy="16.25" x="10"><tspan id="SvgjsTspan1348" style="">");</tspan></tspan><tspan id="SvgjsTspan1349" dy="16.25" x="10"><tspan id="SvgjsTspan1350" style="">        setState(nextc);</tspan></tspan><tspan id="SvgjsTspan1351" dy="16.25" x="10"><tspan id="SvgjsTspan1352" style="">        return true;</tspan></tspan><tspan id="SvgjsTspan1353" dy="16.25" x="10"><tspan id="SvgjsTspan1354" style="">    }</tspan></tspan><tspan id="SvgjsTspan1355" dy="16.25" x="10"><tspan id="SvgjsTspan1356" style="">    return false;</tspan></tspan><tspan id="SvgjsTspan1357" dy="16.25" x="10"><tspan id="SvgjsTspan1358" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1359" transform="translate(1076.853494623656,789.6978098065557)"><path id="SvgjsPath1360" d="M 0 0L 444.8333333333335 0L 460.8333333333335 16L 460.8333333333335 168.14015151515162L 0 168.14015151515162L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath1361" d="M 444.8333333333335 0L 444.8333333333335 16L 460.8333333333335 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath1362" d="M 0 0L 444.8333333333335 0L 460.8333333333335 16L 460.8333333333335 168.14015151515162L 0 168.14015151515162L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1363"><text id="SvgjsText1364" font-family="微软雅黑" text-anchor="start" font-size="13px" width="441px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.445075757575808" transform="rotate(0)"><tspan id="SvgjsTspan1365" dy="16.25" x="10"><tspan id="SvgjsTspan1366" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1367" style=""> 方法，尝试获取锁，以下几种情况，会导致获取锁失败：</tspan></tspan><tspan id="SvgjsTspan1368" dy="16.25" x="10"><tspan id="SvgjsTspan1369" style="">1. 锁已经被其他线程获取</tspan></tspan><tspan id="SvgjsTspan1370" dy="16.25" x="10"><tspan id="SvgjsTspan1371" style="">2. 锁没有被其他线程获取，但当前线程需要排队</tspan></tspan><tspan id="SvgjsTspan1372" dy="16.25" x="10"><tspan id="SvgjsTspan1373" style="">3. CAS 失败(可能过程中已经有其他线程拿到锁了)</tspan></tspan><tspan id="SvgjsTspan1374" dy="16.25" x="10"><tspan id="SvgjsTspan1375" style=""> </tspan></tspan><tspan id="SvgjsTspan1376" dy="16.25" x="10"><tspan id="SvgjsTspan1377" style="">锁为自由状态(</tspan><tspan id="SvgjsTspan1378" style="font-style: italic;">c == 0</tspan><tspan id="SvgjsTspan1379" style="">)，并不能说明可以立刻执行 CAS 获取锁，因为可能在</tspan></tspan><tspan id="SvgjsTspan1380" dy="16.25" x="10"><tspan id="SvgjsTspan1381" style="">当前线程获取锁之前，已经有其他线程在排队了，必须遵循先来后到原则获</tspan></tspan><tspan id="SvgjsTspan1382" dy="16.25" x="10"><tspan id="SvgjsTspan1383" style="">取锁。所以还要调用 </tspan><tspan id="SvgjsTspan1384" style="font-style: italic;">hasQueuedPredecessors</tspan><tspan id="SvgjsTspan1385" style=""> 方法，查看自己是否需要排</tspan></tspan><tspan id="SvgjsTspan1386" dy="16.25" x="10"><tspan id="SvgjsTspan1387" style="">队</tspan></tspan></text></g></g><g id="SvgjsG1388"><path id="SvgjsPath1389" d="M1641.991794622363 851.6102663594663C 1599.791063790204 851.5678000313848 1580.636355564635 873.7678855641317 1537.6868279569894 873.7678855641317" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1390"><path id="SvgjsPath1391" d="M1827.5301177940974 1027.9352276946136C 1827.636424731183 1094.4041695865697 1702.2088266598232 1052.3006698098313 1686.2325228914895 1116.8212603362933" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect1392" width="170" height="16" x="1665.8735763787388" y="1067.2500511099684" fill="#ffffff"></rect><text id="SvgjsText1393" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="170px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1064.6250511099684" transform="rotate(0)"><tspan id="SvgjsTspan1394" dy="16.25" x="1750.8735763787388"><tspan id="SvgjsTspan1395" style="">tryAcquire 方法执行流程详解</tspan></tspan></text></g><g id="SvgjsG1396" transform="translate(1625.0322580645163,1117.5155744463839)"><path id="SvgjsPath1397" d="M 0 35L 60.91666666666677 0L 121.83333333333354 35L 60.91666666666677 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1398"><text id="SvgjsText1399" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="102px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1400" dy="16.25" x="61"><tspan id="SvgjsTspan1401" style="">getState() == 0</tspan></tspan></text></g></g><g id="SvgjsG1402"><path id="SvgjsPath1403" d="M1624.2822580645163 1152.5155744463834L1439.9697580645163 1152.5155744463834L1439.9697580645163 1421.0655744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1404)"></path><rect id="SvgjsRect1406" width="136" height="16" x="1371.9697580645163" y="1247.3595280385298" fill="#ffffff"></rect><text id="SvgjsText1407" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="136px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1244.7345280385298" transform="rotate(0)"><tspan id="SvgjsTspan1408" dy="16.25" x="1439.9697580645163"><tspan id="SvgjsTspan1409" style="">== 0 表示锁为自由状态</tspan></tspan></text></g><g id="SvgjsG1410" transform="translate(1346.2822580645163,1423.7655744463839)"><path id="SvgjsPath1411" d="M 0 43.125L 93.6875 0L 187.375 43.125L 93.6875 86.25Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1412"><text id="SvgjsText1413" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="168px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="32.93125" transform="rotate(0)"><tspan id="SvgjsTspan1414" dy="16.25" x="94"><tspan id="SvgjsTspan1415" style="font-style: italic;">hasQueuedPredecessors()</tspan></tspan></text></g></g><g id="SvgjsG1416"><path id="SvgjsPath1417" d="M1747.6155913978498 1152.5155744463834L1799.6572580645163 1152.5155744463834L1799.6572580645163 1242.3155744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1418)"></path><rect id="SvgjsRect1420" width="107" height="16" x="1746.1572580645163" y="1183.0622047876514" fill="#ffffff"></rect><text id="SvgjsText1421" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="107px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1180.4372047876514" transform="rotate(0)"><tspan id="SvgjsTspan1422" dy="16.25" x="1799.6572580645163"><tspan id="SvgjsTspan1423" style="">!= 0 表示占用状态</tspan></tspan></text></g><g id="SvgjsG1424" transform="translate(1725.0322580645163,1241.2655744463839)"><path id="SvgjsPath1425" d="M 0 35L 74.625 0L 149.25 35L 74.625 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1426"><text id="SvgjsText1427" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="130px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.225" transform="rotate(0)"><tspan id="SvgjsTspan1428" dy="16.25" x="75"><tspan id="SvgjsTspan1429" style="">判断之前是不是当前线</tspan></tspan><tspan id="SvgjsTspan1430" dy="16.25" x="75"><tspan id="SvgjsTspan1431" style="">程获取到锁的</tspan></tspan></text></g></g><g id="SvgjsG1432"><path id="SvgjsPath1433" d="M1832.877158410967 1257.078061432477C 1846.4910134193556 1227.761560636868 1869.460781023998 1213.7655744463839 1902.5322580645163 1213.7655744463839" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1434" transform="translate(1009.9948424153447,2000.9831686802333)"><path id="SvgjsPath1435" d="M 0 0L 1092.0687496164196 0L 1092.0687496164196 1175.0000000000002L 0 1175.0000000000002Z" stroke-dasharray="10,6,3,6" stroke="rgba(91,121,232,1)" stroke-width="2" fill-opacity="1" fill="#f2f2f2"></path><g id="SvgjsG1436"><text id="SvgjsText1437" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1073px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="576.8750000000001" transform="rotate(0)"></text></g></g><g id="SvgjsG1438" transform="translate(1902.5322580645163,1195.0155744463839)"><path id="SvgjsPath1439" d="M 0 0L 127.75 0L 143.75 16L 143.75 37.5L 0 37.5L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath1440" d="M 127.75 0L 127.75 16L 143.75 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath1441" d="M 0 0L 127.75 0L 143.75 16L 143.75 37.5L 0 37.5L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1442"><text id="SvgjsText1443" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="124px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.125" transform="rotate(0)"><tspan id="SvgjsTspan1444" dy="16.25" x="72"><tspan id="SvgjsTspan1445" style="">重入锁的实现原理</tspan></tspan></text></g></g><g id="SvgjsG1446"><path id="SvgjsPath1447" d="M1875.0322580645163 1276.2655744463839L1935.7874663978498 1276.2655744463839L1935.7874663978498 1343.0655744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1448)"></path><rect id="SvgjsRect1450" width="13" height="16" x="1929.2874663978498" y="1296.6058002643776" fill="#ffffff"></rect><text id="SvgjsText1451" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1293.9808002643776" transform="rotate(0)"><tspan id="SvgjsTspan1452" dy="16.25" x="1935.7874663978498"><tspan id="SvgjsTspan1453" style="">是</tspan></tspan></text></g><g id="SvgjsG1454" transform="translate(1870.0322580645163,1343.0155744463839)"><path id="SvgjsPath1455" d="M 0 4Q 0 0 4 0L 122.25 0Q 126.25 0 126.25 4L 126.25 50Q 126.25 54 122.25 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1456"><text id="SvgjsText1457" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="107px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1458" dy="16.25" x="63.5"><tspan id="SvgjsTspan1459" style="">设置重入锁计数器</tspan></tspan></text></g></g><g id="SvgjsG1460"><path id="SvgjsPath1461" d="M1724.2822580645163 1276.2655744463839L1685.948924731183 1276.2655744463839L1685.948924731183 1340.3155744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1462)"></path><rect id="SvgjsRect1464" width="13" height="16" x="1679.448924731183" y="1294.3450626353601" fill="#ffffff"></rect><text id="SvgjsText1465" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1291.7200626353601" transform="rotate(0)"><tspan id="SvgjsTspan1466" dy="16.25" x="1685.948924731183"><tspan id="SvgjsTspan1467" style="">否</tspan></tspan></text></g><g id="SvgjsG1468" transform="translate(1610.073924731183,1343.0155744463839)"><path id="SvgjsPath1469" d="M 0 4Q 0 0 4 0L 147.75 0Q 151.75 0 151.75 4L 151.75 50Q 151.75 54 147.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f9f630"></path><g id="SvgjsG1470"><text id="SvgjsText1471" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="132px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.125" transform="rotate(0)"><tspan id="SvgjsTspan1472" dy="16.25" x="76"><tspan id="SvgjsTspan1473" style="">整个 </tspan><tspan id="SvgjsTspan1474" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1475" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1476" dy="16.25" x="76"><tspan id="SvgjsTspan1477" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1478" style="">，表示获取锁失</tspan></tspan><tspan id="SvgjsTspan1479" dy="16.25" x="76"><tspan id="SvgjsTspan1480" style="">败</tspan></tspan></text></g></g><g id="SvgjsG1481"><path id="SvgjsPath1482" d="M1938.7822580645166 1397.2655744463839L1938.7822580645166 1431.3905744463839L1938.5322580645166 1431.3905744463839L1938.5322580645166 1463.5655744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1483)"></path></g><g id="SvgjsG1485" transform="translate(1864.5322580645163,1466.2655744463839)"><path id="SvgjsPath1486" d="M 0 4Q 0 0 4 0L 144 0Q 148 0 148 4L 148 50Q 148 54 144 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG1487"><text id="SvgjsText1488" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="128px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1489" dy="16.25" x="74"><tspan id="SvgjsTspan1490" style="">整个 </tspan><tspan id="SvgjsTspan1491" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1492" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1493" dy="16.25" x="74"><tspan id="SvgjsTspan1494" style="font-style: italic;">true</tspan><tspan id="SvgjsTspan1495" style="">，表示获取锁成功</tspan></tspan></text></g></g><g id="SvgjsG1496" transform="translate(1176.2822580645163,1533.0155744463839)"><path id="SvgjsPath1497" d="M 0 4Q 0 0 4 0L 159.75 0Q 163.75 0 163.75 4L 163.75 50Q 163.75 54 159.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1498"><text id="SvgjsText1499" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="144px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1500" dy="16.25" x="82"><tspan id="SvgjsTspan1501" style="">返回 </tspan><tspan id="SvgjsTspan1502" style="font-style: italic;">true</tspan><tspan id="SvgjsTspan1503" style="">，表示需要排</tspan></tspan><tspan id="SvgjsTspan1504" dy="16.25" x="82"><tspan id="SvgjsTspan1505" style="">队</tspan></tspan></text></g></g><g id="SvgjsG1506"><path id="SvgjsPath1507" d="M1345.5322580645163 1466.8905744463839L1258.1572580645163 1466.8905744463839L1258.1572580645163 1530.3155744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1508)"></path><rect id="SvgjsRect1510" width="24" height="16" x="1246.157258064516" y="1473.428985217239" fill="#ffffff"></rect><text id="SvgjsText1511" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1470.803985217239" transform="rotate(0)"><tspan id="SvgjsTspan1512" dy="16.25" x="1258.157258064516"><tspan id="SvgjsTspan1513" style="">true</tspan></tspan></text></g><g id="SvgjsG1514"><path id="SvgjsPath1515" d="M1534.4072580645163 1466.8905744463839L1604.7822580645163 1466.8905744463839L1604.7822580645163 1530.3155744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1516)"></path><rect id="SvgjsRect1518" width="29" height="16" x="1590.2822580645166" y="1476.956485119287" fill="#ffffff"></rect><text id="SvgjsText1519" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1474.331485119287" transform="rotate(0)"><tspan id="SvgjsTspan1520" dy="16.25" x="1604.7822580645166"><tspan id="SvgjsTspan1521" style="">false</tspan></tspan></text></g><g id="SvgjsG1522" transform="translate(1517.4072580645163,1533.0155744463839)"><path id="SvgjsPath1523" d="M 0 4Q 0 0 4 0L 170.75 0Q 174.75 0 174.75 4L 174.75 50Q 174.75 54 170.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1524"><text id="SvgjsText1525" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="155px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1526" dy="16.25" x="87.5"><tspan id="SvgjsTspan1527" style="">返回 </tspan><tspan id="SvgjsTspan1528" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1529" style="">，表示无需排队</tspan></tspan></text></g></g><g id="SvgjsG1530" transform="translate(1182.2822580645163,1651.7655744463839)"><path id="SvgjsPath1531" d="M 0 4Q 0 0 4 0L 147.75 0Q 151.75 0 151.75 4L 151.75 50Q 151.75 54 147.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f9f630"></path><g id="SvgjsG1532"><text id="SvgjsText1533" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="132px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.125" transform="rotate(0)"><tspan id="SvgjsTspan1534" dy="16.25" x="76"><tspan id="SvgjsTspan1535" style="">整个 </tspan><tspan id="SvgjsTspan1536" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1537" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1538" dy="16.25" x="76"><tspan id="SvgjsTspan1539" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1540" style="">，表示获取锁失</tspan></tspan><tspan id="SvgjsTspan1541" dy="16.25" x="76"><tspan id="SvgjsTspan1542" style="">败</tspan></tspan></text></g></g><g id="SvgjsG1543"><path id="SvgjsPath1544" d="M1258.1572580645163 1587.7655744463839L1258.1572580645163 1619.3905744463839L1258.1572580645163 1619.3905744463839L1258.1572580645163 1649.0655744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1545)"></path></g><g id="SvgjsG1547"><path id="SvgjsPath1548" d="M1604.7822580645163 1587.7655744463839L1604.7822580645163 1610.7030744463839L1604.7822580645163 1610.7030744463839L1604.7822580645163 1631.6905744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1549)"></path></g><g id="SvgjsG1551" transform="translate(1515.7197580645163,1634.3905744463839)"><path id="SvgjsPath1552" d="M 0 44.375L 89.0625 0L 178.125 44.375L 89.0625 88.75Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1553"><text id="SvgjsText1554" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="159px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.69375" transform="rotate(0)"><tspan id="SvgjsTspan1555" dy="16.25" x="89.5"><tspan id="SvgjsTspan1556" style="">执行 </tspan></tspan><tspan id="SvgjsTspan1557" dy="16.25" x="89.5"><tspan id="SvgjsTspan1558" style="font-style: italic;">compareAndSetState(0, 1)</tspan><tspan id="SvgjsTspan1559" style=""> </tspan></tspan><tspan id="SvgjsTspan1560" dy="16.25" x="89.5"><tspan id="SvgjsTspan1561" style="">尝试获取锁</tspan></tspan></text></g></g><g id="SvgjsG1562" transform="translate(1677.1383186705773,1770.5155744463839)"><path id="SvgjsPath1563" d="M 0 4Q 0 0 4 0L 147.75 0Q 151.75 0 151.75 4L 151.75 50Q 151.75 54 147.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f9f630"></path><g id="SvgjsG1564"><text id="SvgjsText1565" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="132px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.125" transform="rotate(0)"><tspan id="SvgjsTspan1566" dy="16.25" x="76"><tspan id="SvgjsTspan1567" style="">整个 </tspan><tspan id="SvgjsTspan1568" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1569" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1570" dy="16.25" x="76"><tspan id="SvgjsTspan1571" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1572" style="">，表示获取锁失</tspan></tspan><tspan id="SvgjsTspan1573" dy="16.25" x="76"><tspan id="SvgjsTspan1574" style="">败</tspan></tspan></text></g></g><g id="SvgjsG1575"><path id="SvgjsPath1576" d="M1694.5947580645163 1678.7655744463839L1753.0133186705773 1678.7655744463839L1753.0133186705773 1767.8155744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1577)"></path><rect id="SvgjsRect1579" width="29" height="16" x="1738.5133186705773" y="1712.9128549885186" fill="#ffffff"></rect><text id="SvgjsText1580" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1710.2878549885186" transform="rotate(0)"><tspan id="SvgjsTspan1581" dy="16.25" x="1753.0133186705773"><tspan id="SvgjsTspan1582" style="">false</tspan></tspan></text></g><g id="SvgjsG1583"><path id="SvgjsPath1584" d="M1514.9697580645163 1678.7655744463839L1450.6572580645163 1678.7655744463839L1450.6572580645163 1759.1905744463838" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1585)"></path><rect id="SvgjsRect1587" width="24" height="16" x="1438.6572580645163" y="1707.3980376753225" fill="#ffffff"></rect><text id="SvgjsText1588" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1704.7730376753225" transform="rotate(0)"><tspan id="SvgjsTspan1589" dy="16.25" x="1450.6572580645163"><tspan id="SvgjsTspan1590" style="">true</tspan></tspan></text></g><g id="SvgjsG1591" transform="translate(1318.7822580645163,1761.8905744463839)"><path id="SvgjsPath1592" d="M 0 4Q 0 0 4 0L 259.75 0Q 263.75 0 263.75 4L 263.75 67.25Q 263.75 71.25 259.75 71.25L 4 71.25Q 0 71.25 0 67.25Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1593"><text id="SvgjsText1594" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="244px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.5" transform="rotate(0)"><tspan id="SvgjsTspan1595" dy="16.25" x="132"><tspan id="SvgjsTspan1596" style="">调</tspan></tspan><tspan id="SvgjsTspan1597" dy="16.25" x="132"><tspan id="SvgjsTspan1598" style="">用 </tspan><tspan id="SvgjsTspan1599" style="font-style: italic;">setExclusiveOwnerThread(current)</tspan><tspan id="SvgjsTspan1600" style="">，</tspan></tspan><tspan id="SvgjsTspan1601" dy="16.25" x="132"><tspan id="SvgjsTspan1602" style="">设置当前线程为锁持有线程</tspan></tspan></text></g></g><g id="SvgjsG1603" transform="translate(1376.6572580645163,1897.5155744463834)"><path id="SvgjsPath1604" d="M 0 4Q 0 0 4 0L 144 0Q 148 0 148 4L 148 50Q 148 54 144 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG1605"><text id="SvgjsText1606" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="128px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1607" dy="16.25" x="74"><tspan id="SvgjsTspan1608" style="">整个 </tspan><tspan id="SvgjsTspan1609" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan1610" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1611" dy="16.25" x="74"><tspan id="SvgjsTspan1612" style="font-style: italic;">true</tspan><tspan id="SvgjsTspan1613" style="">，表示获取锁成功</tspan></tspan></text></g></g><g id="SvgjsG1614"><path id="SvgjsPath1615" d="M1450.6572580645163 1833.8905744463839L1450.6572580645163 1865.3280744463837L1450.6572580645163 1865.3280744463837L1450.6572580645163 1894.8155744463834" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1616)"></path></g><g id="SvgjsG1618"><path id="SvgjsPath1619" d="M1398.960814976024 1442.7346230037363C 987.25 1216.1666666666667 969.75 2117.416666666667 1131.9800406671925 2157.1066798177126" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect1620" width="182" height="48" x="952.980893398146" y="1717.610147857872" fill="#ffffff"></rect><text id="SvgjsText1621" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="182px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1714.985147857872" transform="rotate(0)"><tspan id="SvgjsTspan1622" dy="16.25" x="1043.980893398146"><tspan id="SvgjsTspan1623" style="">判断在当前线程前面，是否</tspan></tspan><tspan id="SvgjsTspan1624" dy="16.25" x="1043.980893398146"><tspan id="SvgjsTspan1625" style="">已经有其他线程在排队了；</tspan></tspan><tspan id="SvgjsTspan1626" dy="16.25" x="1043.980893398146"><tspan id="SvgjsTspan1627" style="">有，则表示当前线程也需要排队</tspan></tspan></text></g><g id="SvgjsG1628" transform="translate(1132.691611355436,2057.96867592661)"><path id="SvgjsPath1629" d="M 0 0L 563.1752873563219 0L 563.1752873563219 198.75L 0 198.75Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1630"><text id="SvgjsText1631" font-family="微软雅黑" text-anchor="start" font-size="13px" width="544px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="15.25" transform="rotate(0)"><tspan id="SvgjsTspan1632" dy="16.25" x="10"><tspan id="SvgjsTspan1633" style="">public final boolean hasQueuedPredecessors() {</tspan></tspan><tspan id="SvgjsTspan1634" dy="16.25" x="10"><tspan id="SvgjsTspan1635" style="">    // The correctness of this depends on head being initialized</tspan></tspan><tspan id="SvgjsTspan1636" dy="16.25" x="10"><tspan id="SvgjsTspan1637" style="">    // before tail and on head.next being accurate if the current</tspan></tspan><tspan id="SvgjsTspan1638" dy="16.25" x="10"><tspan id="SvgjsTspan1639" style="">    // thread is first in queue.</tspan></tspan><tspan id="SvgjsTspan1640" dy="16.25" x="10"><tspan id="SvgjsTspan1641" style="">    AbstractQueuedSynchronizer.Node t = tail; // Read fields in reverse initialization order</tspan></tspan><tspan id="SvgjsTspan1642" dy="16.25" x="10"><tspan id="SvgjsTspan1643" style="">    AbstractQueuedSynchronizer.Node h = head;</tspan></tspan><tspan id="SvgjsTspan1644" dy="16.25" x="10"><tspan id="SvgjsTspan1645" style="">    AbstractQueuedSynchronizer.Node s;</tspan></tspan><tspan id="SvgjsTspan1646" dy="16.25" x="10"><tspan id="SvgjsTspan1647" style="">    return h != t &amp;&amp;</tspan></tspan><tspan id="SvgjsTspan1648" dy="16.25" x="10"><tspan id="SvgjsTspan1649" style="">            ((s = h.next) == null || s.thread != Thread.currentThread());</tspan></tspan><tspan id="SvgjsTspan1650" dy="16.25" x="10"><tspan id="SvgjsTspan1651" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1652"><path id="SvgjsPath1653" d="M1414.2792550335969 2257.46867592661L1414.2792550335969 2293.34367592661L1414.2792550335969 2293.34367592661L1414.2792550335969 2329.21867592661" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect1654" width="231" height="16" x="1298.7792550335969" y="2283.66578060367" fill="#ffffff"></rect><text id="SvgjsText1655" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="231px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2281.04078060367" transform="rotate(0)"><tspan id="SvgjsTspan1656" dy="16.25" x="1414.2792550335969"><tspan id="SvgjsTspan1657" style="">hasQueuedPredecessors 方法执行流程</tspan></tspan></text></g><g id="SvgjsG1658" transform="translate(1334.4854331945164,2329.96867592661)"><path id="SvgjsPath1659" d="M 0 35L 79.79382183908046 0L 159.58764367816093 35L 79.79382183908046 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1660"><text id="SvgjsText1661" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="140px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1662" dy="16.25" x="80"><tspan id="SvgjsTspan1663" style="">队列是否初始化？</tspan></tspan></text></g></g><g id="SvgjsG1664"><path id="SvgjsPath1665" d="M1333.7354331945164 2364.96867592661L1232.6916113554357 2364.96867592661L1232.6916113554357 2437.0626574080916" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1666)"></path><rect id="SvgjsRect1668" width="26" height="16" x="1219.6916113554357" y="2388.8205531426374" fill="#ffffff"></rect><text id="SvgjsText1669" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2386.1955531426374" transform="rotate(0)"><tspan id="SvgjsTspan1670" dy="16.25" x="1232.6916113554357"><tspan id="SvgjsTspan1671" style="">没有</tspan></tspan></text></g><g id="SvgjsG1672" transform="translate(1123.9416113554357,2440.21867592661)"><path id="SvgjsPath1673" d="M 0 4Q 0 0 4 0L 213.5 0Q 217.5 0 217.5 4L 217.5 94.5Q 217.5 98.5 213.5 98.5L 4 98.5Q 0 98.5 0 94.5Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG1674"><text id="SvgjsText1675" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="198px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="14.125" transform="rotate(0)"><tspan id="SvgjsTspan1676" dy="16.25" x="109"><tspan id="SvgjsTspan1677" style="">队列没有初始化，则 </tspan><tspan id="SvgjsTspan1678" style="font-style: italic;">h != t</tspan><tspan id="SvgjsTspan1679" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1680" dy="16.25" x="109"><tspan id="SvgjsTspan1681" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1682" style="">，因为此时 </tspan><tspan id="SvgjsTspan1683" style="font-style: italic;">h == t == null</tspan><tspan id="SvgjsTspan1684" style="">。</tspan></tspan><tspan id="SvgjsTspan1685" dy="16.25" x="109"><tspan id="SvgjsTspan1686" style="">整个 </tspan><tspan id="SvgjsTspan1687" style="font-style: italic;">hasQueuedPredecessors</tspan><tspan id="SvgjsTspan1688" style=""> 方</tspan></tspan><tspan id="SvgjsTspan1689" dy="16.25" x="109"><tspan id="SvgjsTspan1690" style="">法返回 false，</tspan><tspan id="SvgjsTspan1691" style="font-weight: bold;fill: rgb(167, 147, 44);">表示不需要排队</tspan></tspan></text></g></g><g id="SvgjsG1692"><path id="SvgjsPath1693" d="M1494.8230768726771 2364.96867592661L1577.6916113554348 2364.96867592661L1577.6916113554348 2451.7686759266103" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1694)"></path><rect id="SvgjsRect1696" width="65" height="16" x="1545.1916113554348" y="2400.155496049359" fill="#ffffff"></rect><text id="SvgjsText1697" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="65px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2397.530496049359" transform="rotate(0)"><tspan id="SvgjsTspan1698" dy="16.25" x="1577.6916113554348"><tspan id="SvgjsTspan1699" style="">已经初始化</tspan></tspan></text></g><g id="SvgjsG1700" transform="translate(1529.6916113554357,2454.46867592661)"><path id="SvgjsPath1701" d="M 0 35L 48 0L 96 35L 48 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1702"><text id="SvgjsText1703" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan1704" dy="16.25" x="48"><tspan id="SvgjsTspan1705" style="">元素个数 &gt; 1</tspan></tspan></text></g></g><g id="SvgjsG1706"><path id="SvgjsPath1707" d="M1528.9416113554357 2489.46867592661L1385.7605768726771 2489.46867592661L1385.7605768726771 2562.9046408388904" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1708)"></path><rect id="SvgjsRect1710" width="13" height="16" x="1379.2605768726771" y="2515.0424392522145" fill="#ffffff"></rect><text id="SvgjsText1711" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2512.4174392522145" transform="rotate(0)"><tspan id="SvgjsTspan1712" dy="16.25" x="1385.7605768726771"><tspan id="SvgjsTspan1713" style="">否</tspan></tspan></text></g><g id="SvgjsG1714" transform="translate(1325.3855768726771,2565.60464083889)"><path id="SvgjsPath1715" d="M 0 4Q 0 0 4 0L 116.75 0Q 120.75 0 120.75 4L 120.75 50Q 120.75 54 116.75 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1716"><text id="SvgjsText1717" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="101px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1718" dy="16.25" x="60.5"><tspan id="SvgjsTspan1719" style="">队列元素等于 1</tspan></tspan></text></g></g><g id="SvgjsG1720"><path id="SvgjsPath1721" d="M1626.4416113554341 2489.46867592661L1764.1916113554341 2489.46867592661L1764.1916113554341 2558.51867592661" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1722)"></path><rect id="SvgjsRect1724" width="13" height="16" x="1757.691611355434" y="2514.8635035128164" fill="#ffffff"></rect><text id="SvgjsText1725" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2512.2385035128164" transform="rotate(0)"><tspan id="SvgjsTspan1726" dy="16.25" x="1764.191611355434"><tspan id="SvgjsTspan1727" style="">是</tspan></tspan></text></g><g id="SvgjsG1728" transform="translate(1706.4416113554344,2561.2186759266096)"><path id="SvgjsPath1729" d="M 0 4Q 0 0 4 0L 111.5 0Q 115.5 0 115.5 4L 115.5 50Q 115.5 54 111.5 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1730"><text id="SvgjsText1731" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="96px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1732" dy="16.25" x="58"><tspan id="SvgjsTspan1733" style="">队列元素大于 1</tspan></tspan></text></g></g><g id="SvgjsG1734"><path id="SvgjsPath1735" d="M1764.1916113554341 2615.9686759266096L1764.1916113554341 2658.84367592661L1764.1916113554341 2658.84367592661L1764.1916113554341 2699.7686759266107" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1736)"></path></g><g id="SvgjsG1738" transform="translate(1639.8791113554344,2702.4686759266106)"><path id="SvgjsPath1739" d="M 0 4Q 0 0 4 0L 244.625 0Q 248.625 0 248.625 4L 248.625 84.75Q 248.625 88.75 244.625 88.75L 4 88.75Q 0 88.75 0 84.75Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1740"><text id="SvgjsText1741" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="229px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.25" transform="rotate(0)"><tspan id="SvgjsTspan1742" dy="16.25" x="124.5"><tspan id="SvgjsTspan1743" style="">队列元素大于 1，则至少为 2 个，</tspan></tspan><tspan id="SvgjsTspan1744" dy="16.25" x="124.5"><tspan id="SvgjsTspan1745" style="font-style: italic;">h.next</tspan><tspan id="SvgjsTspan1746" style=""> 指向第二个元素，肯定不是</tspan></tspan><tspan id="SvgjsTspan1747" dy="16.25" x="124.5"><tspan id="SvgjsTspan1748" style="font-style: italic;">null</tspan><tspan id="SvgjsTspan1749" style="">，所以 </tspan><tspan id="SvgjsTspan1750" style="font-style: italic;">(s = h.next) == null</tspan><tspan id="SvgjsTspan1751" style=""> 返回 </tspan></tspan><tspan id="SvgjsTspan1752" dy="16.25" x="124.5"><tspan id="SvgjsTspan1753" style="font-style: italic;">false</tspan></tspan></text></g></g><g id="SvgjsG1754"><path id="SvgjsPath1755" d="M1385.7605768726771 2620.35464083889L1385.7605768726771 2667.6671408388906L1385.7605768726771 2667.6671408388906L1385.7605768726771 2713.0296408388913" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1756)"></path></g><g id="SvgjsG1758" transform="translate(1277.4480768726773,2715.729640838891)"><path id="SvgjsPath1759" d="M 0 4Q 0 0 4 0L 212.625 0Q 216.625 0 216.625 4L 216.625 67Q 216.625 71 212.625 71L 4 71Q 0 71 0 67Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1760"><text id="SvgjsText1761" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="197px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.375" transform="rotate(0)"><tspan id="SvgjsTspan1762" dy="16.25" x="108.5"><tspan id="SvgjsTspan1763" style="">当最后一个排队线程也获取到锁之</tspan></tspan><tspan id="SvgjsTspan1764" dy="16.25" x="108.5"><tspan id="SvgjsTspan1765" style="">后，此时 </tspan><tspan id="SvgjsTspan1766" style="font-style: italic;">head = tail</tspan><tspan id="SvgjsTspan1767" style="">，且 </tspan><tspan id="SvgjsTspan1768" style="font-style: italic;">!= </tspan></tspan><tspan id="SvgjsTspan1769" dy="16.25" x="108.5"><tspan id="SvgjsTspan1770" style="font-style: italic;">null</tspan><tspan id="SvgjsTspan1771" style="">。排队队列如左图</tspan></tspan></text></g></g><g id="SvgjsG1772"><path id="SvgjsPath1773" d="M1276.6980768726773 2751.229640838891L1244.9733528859865 2751.229640838891L1244.9733528859865 2751.229640838891L1213.2486288992957 2751.229640838891" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG1774" transform="translate(1030.691611355436,2628.6489956776004)"><path id="SvgjsPath1775" d="M 0 0L 181.80701754385964 0L 181.80701754385964 245.16129032258073L 0 245.16129032258073Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e9e9e9"></path><g id="SvgjsG1776"><text id="SvgjsText1777" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="162px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="111.95564516129036" transform="rotate(0)"></text></g></g><g id="SvgjsG1778" transform="translate(1083.691611355436,2644.9796223846206)"><path id="SvgjsPath1779" d="M 0 4Q 0 0 4 0L 72.0701754385965 0Q 76.0701754385965 0 76.0701754385965 4L 76.0701754385965 23Q 76.0701754385965 27 72.0701754385965 27L 4 27Q 0 27 0 23Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1780"><text id="SvgjsText1781" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="57px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.875" transform="rotate(0)"><tspan id="SvgjsTspan1782" dy="16.25" x="38.5"><tspan id="SvgjsTspan1783" style="">head</tspan></tspan></text></g></g><g id="SvgjsG1784" transform="translate(1083.691611355436,2709.0147101039192)"><path id="SvgjsPath1785" d="M 0 4Q 0 0 4 0L 72.0701754385965 0Q 76.0701754385965 0 76.0701754385965 4L 76.0701754385965 23Q 76.0701754385965 27 72.0701754385965 27L 4 27Q 0 27 0 23Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1786"><text id="SvgjsText1787" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="57px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.875" transform="rotate(0)"><tspan id="SvgjsTspan1788" dy="16.25" x="38.5"><tspan id="SvgjsTspan1789" style="">tail</tspan></tspan></text></g></g><g id="SvgjsG1790" transform="translate(1069.6916113554357,2773.049797823217)"><path id="SvgjsPath1791" d="M 0 0L 104.5263157894737 0L 104.5263157894737 88.40350877192986L 0 88.40350877192986Z" stroke="rgba(166,174,243,1)" stroke-width="1.5" fill-opacity="1" fill="#fad8ea"></path><g id="SvgjsG1792"><text id="SvgjsText1793" font-family="微软雅黑" text-anchor="start" font-size="13px" width="85px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.0767543859649322" transform="rotate(0)"><tspan id="SvgjsTspan1794" dy="16.25" x="10"><tspan id="SvgjsTspan1795" style="">Node : n1</tspan></tspan><tspan id="SvgjsTspan1796" dy="16.25" x="10"><tspan id="SvgjsTspan1797" style=""> </tspan></tspan><tspan id="SvgjsTspan1798" dy="16.25" x="10"><tspan id="SvgjsTspan1799" style="">thread = null</tspan></tspan><tspan id="SvgjsTspan1800" dy="16.25" x="10"><tspan id="SvgjsTspan1801" style="">prev = null</tspan></tspan><tspan id="SvgjsTspan1802" dy="16.25" x="10"><tspan id="SvgjsTspan1803" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG1804"><path id="SvgjsPath1805" d="M1082.941611355436 2658.4796223846206L1039.691611355436 2658.4796223846206L1039.691611355436 2817.2515522091826L1066.9916113554357 2817.2515522091826" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1806)"></path></g><g id="SvgjsG1808"><path id="SvgjsPath1809" d="M1174.96792714491 2817.2515522091826L1204.2179271449097 2817.2515522091826L1204.2179271449097 2722.5147101039192L1162.4617867940326 2722.5147101039192" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1810)"></path></g><g id="SvgjsG1812"><path id="SvgjsPath1813" d="M1385.7605768726771 2787.479640838891L1385.7605768726771 2834.7921408388906L1385.7605768726771 2834.7921408388906L1385.7605768726771 2880.1546408388904" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1814)"></path></g><g id="SvgjsG1816" transform="translate(1323.1410593288176,2882.85464083889)"><path id="SvgjsPath1817" d="M 0 4Q 0 0 4 0L 121.23903508771923 0Q 125.23903508771923 0 125.23903508771923 4L 125.23903508771923 50Q 125.23903508771923 54 121.23903508771923 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1818"><text id="SvgjsText1819" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="106px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1820" dy="16.25" x="63"><tspan id="SvgjsTspan1821" style="font-style: italic;">h != t</tspan><tspan id="SvgjsTspan1822" style=""> 返回 </tspan><tspan id="SvgjsTspan1823" style="font-style: italic;">false</tspan></tspan></text></g></g><g id="SvgjsG1824"><path id="SvgjsPath1825" d="M1764.1916113554341 2791.9686759266106L1764.1916113554341 2838.5248553004835L1764.1916113554341 2838.5248553004835L1764.1916113554341 2883.1310346743567" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1826)"></path></g><g id="SvgjsG1828" transform="translate(1642.9152955659606,2885.806395224855)"><path id="SvgjsPath1829" d="M 0 19.662280701754526L 121.27631578947376 0L 242.5526315789475 19.662280701754526L 121.27631578947376 39.32456140350905Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1830"><text id="SvgjsText1831" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="223px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="9.233903508772071" transform="rotate(0)"><tspan id="SvgjsTspan1832" dy="16.25" x="121.5"><tspan id="SvgjsTspan1833" style="">s.thread != Thread.currentThread()</tspan></tspan></text></g></g><g id="SvgjsG1834"><path id="SvgjsPath1835" d="M1642.1652955659606 2905.4686759266096L1559.2850549572802 2905.4686759266096L1559.2850549572802 3046.0552256342125" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1836)"></path><rect id="SvgjsRect1838" width="29" height="16" x="1544.7850549572802" y="2967.6528823083863" fill="#ffffff"></rect><text id="SvgjsText1839" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2965.0278823083863" transform="rotate(0)"><tspan id="SvgjsTspan1840" dy="16.25" x="1559.2850549572802"><tspan id="SvgjsTspan1841" style="">false</tspan></tspan></text></g><g id="SvgjsG1842" transform="translate(1323.1410593288176,3048.7552256342124)"><path id="SvgjsPath1843" d="M 0 4Q 0 0 4 0L 461.77631578947376 0Q 465.77631578947376 0 465.77631578947376 4L 465.77631578947376 68.88011695906425Q 465.77631578947376 72.88011695906425 461.77631578947376 72.88011695906425L 4 72.88011695906425Q 0 72.88011695906425 0 68.88011695906425Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG1844"><text id="SvgjsText1845" font-family="微软雅黑" text-anchor="start" font-size="13px" width="446px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.3150584795321265" transform="rotate(0)"><tspan id="SvgjsTspan1846" dy="16.25" x="10"><tspan id="SvgjsTspan1847" style="font-style: italic;">s</tspan><tspan id="SvgjsTspan1848" style=""> 是第二个节点(第一个节点是占位空节点)，代表下一个应该获取锁的线程。</tspan></tspan><tspan id="SvgjsTspan1849" dy="16.25" x="10"><tspan id="SvgjsTspan1850" style="font-style: italic;">s.thread != Thread.currentThread()</tspan><tspan id="SvgjsTspan1851" style=""> 为 </tspan><tspan id="SvgjsTspan1852" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1853" style="">，表示二者相等，即下一个可以</tspan></tspan><tspan id="SvgjsTspan1854" dy="16.25" x="10"><tspan id="SvgjsTspan1855" style="">获取锁的线程，正是当前线程，所以，此时整个 </tspan><tspan id="SvgjsTspan1856" style="font-style: italic;">hasQueuedPredecessors</tspan><tspan id="SvgjsTspan1857" style=""> 返</tspan></tspan><tspan id="SvgjsTspan1858" dy="16.25" x="10"><tspan id="SvgjsTspan1859" style="">回 </tspan><tspan id="SvgjsTspan1860" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1861" style="">，</tspan><tspan id="SvgjsTspan1862" style="font-weight: bold;fill: rgb(167, 147, 44);">表示不需要排队</tspan></tspan></text></g></g><g id="SvgjsG1863"><path id="SvgjsPath1864" d="M1385.7605768726771 2937.604640838891L1385.7605768726771 2957.041044347663L1385.7605768726771 2957.041044347663L1385.7605768726771 2974.527447856435" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1865)"></path></g><g id="SvgjsG1867" transform="translate(1283.906649669612,2977.227447856435)"><path id="SvgjsPath1868" d="M 0 4Q 0 0 4 0L 199.70785440613025 0Q 203.70785440613025 0 203.70785440613025 4L 203.70785440613025 50Q 203.70785440613025 54 199.70785440613025 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG1869"><text id="SvgjsText1870" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="184px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="7.875" transform="rotate(0)"><tspan id="SvgjsTspan1871" dy="16.25" x="102"><tspan id="SvgjsTspan1872" style="">整个 </tspan><tspan id="SvgjsTspan1873" style="font-style: italic;">hasQueuedPredecessors</tspan><tspan id="SvgjsTspan1874" style=""> </tspan></tspan><tspan id="SvgjsTspan1875" dy="16.25" x="102"><tspan id="SvgjsTspan1876" style="">返回 </tspan><tspan id="SvgjsTspan1877" style="font-style: italic;">false</tspan><tspan id="SvgjsTspan1878" style="">，</tspan><tspan id="SvgjsTspan1879" style="font-weight: bold;fill: rgb(167, 147, 44);">表示不需要排队</tspan></tspan></text></g></g><g id="SvgjsG1880"><path id="SvgjsPath1881" d="M1886.2179271449077 2905.4686759266096L1990.7481203816226 2905.4686759266096L1990.7481203816226 3039.847337253841" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker1882)"></path><rect id="SvgjsRect1884" width="24" height="16" x="1978.7481203816226" y="2964.8310297996904" fill="#ffffff"></rect><text id="SvgjsText1885" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2962.2060297996904" transform="rotate(0)"><tspan id="SvgjsTspan1886" dy="16.25" x="1990.7481203816226"><tspan id="SvgjsTspan1887" style="">true</tspan></tspan></text></g><g id="SvgjsG1888" transform="translate(1885.4679271449077,3042.547337253841)"><path id="SvgjsPath1889" d="M 0 4Q 0 0 4 0L 206.56038647342984 0Q 210.56038647342984 0 210.56038647342984 4L 210.56038647342984 81.29589371980637Q 210.56038647342984 85.29589371980637 206.56038647342984 85.29589371980637L 4 85.29589371980637Q 0 85.29589371980637 0 81.29589371980637Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f9f630"></path><g id="SvgjsG1890"><text id="SvgjsText1891" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="191px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.4770531400968139" transform="rotate(0)"><tspan id="SvgjsTspan1892" dy="16.25" x="105.5"><tspan id="SvgjsTspan1893" style="">二者不相等，说明下一个可以获</tspan></tspan><tspan id="SvgjsTspan1894" dy="16.25" x="105.5"><tspan id="SvgjsTspan1895" style="">得锁的线程，不是当前线程，所</tspan></tspan><tspan id="SvgjsTspan1896" dy="16.25" x="105.5"><tspan id="SvgjsTspan1897" style="">以整</tspan></tspan><tspan id="SvgjsTspan1898" dy="16.25" x="105.5"><tspan id="SvgjsTspan1899" style="">个 </tspan><tspan id="SvgjsTspan1900" style="font-style: italic;">hasQueuedPredecessors</tspan><tspan id="SvgjsTspan1901" style=""> 返</tspan></tspan><tspan id="SvgjsTspan1902" dy="16.25" x="105.5"><tspan id="SvgjsTspan1903" style="">回 </tspan><tspan id="SvgjsTspan1904" style="font-style: italic;">true</tspan><tspan id="SvgjsTspan1905" style="">，表示需要排队</tspan></tspan></text></g></g><g id="SvgjsG1906" transform="translate(1012.189108939303,2008.0991107092188)"><path id="SvgjsPath1907" d="M 0 0L 248.81089106069703 0L 248.81089106069703 48.75L 0 48.75Z" stroke="none" fill="none"></path><g id="SvgjsG1908"><text id="SvgjsText1909" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="249px" fill="#7985ec" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="700" font-style="" opacity="1" y="-4" transform="rotate(0)"><tspan id="SvgjsTspan1910" dy="23.75" x="124.5"><tspan id="SvgjsTspan1911" style="">hasQueuedPredecessors </tspan></tspan><tspan id="SvgjsTspan1912" dy="23.75" x="124.5"><tspan id="SvgjsTspan1913" style="">方法执行流程</tspan></tspan></text></g></g><g id="SvgjsG1914" transform="translate(1009.0054527170619,648.7632575757575)"><path id="SvgjsPath1915" d="M 0 0L 236.5 0L 236.5 70.77651515151524L 0 70.77651515151524Z" stroke="none" fill="none"></path><g id="SvgjsG1916"><text id="SvgjsText1917" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="237px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="400" font-style="" opacity="1" y="20.76325757575762" transform="rotate(0)"><tspan id="SvgjsTspan1918" dy="21.25" x="118.5"><tspan id="SvgjsTspan1919" style="font-weight: bold;fill: rgb(167, 147, 44);">tryAcquire 方法执行流程详解</tspan></tspan></text></g></g><g id="SvgjsG1920"><path id="SvgjsPath1921" d="M2966.8465050074715 1085.655315673299C 3318.0249063104966 1085.6666666666663 3402.7781402013616 695.5652680652678 3753.9565415043867 695.5766190586355" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect1922" width="78" height="16" x="3295.2115227228664" y="905.9714357905005" fill="#ffffff"></rect><text id="SvgjsText1923" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="78px" fill="#a7932c" font-weight="700" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="700" font-style="" opacity="1" y="903.3464357905005" transform="rotate(0)"><tspan id="SvgjsTspan1924" dy="16.25" x="3334.2115227228664"><tspan id="SvgjsTspan1925" style="">执行排队逻辑</tspan></tspan></text></g><g id="SvgjsG1926" transform="translate(3754.706455602767,560.0652680652682)"><path id="SvgjsPath1927" d="M 0 0L 388.34920634920627 0L 388.34920634920627 271L 0 271Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1928"><text id="SvgjsText1929" font-family="微软雅黑" text-anchor="start" font-size="13px" width="369px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="18.875" transform="rotate(0)"><tspan id="SvgjsTspan1930" dy="16.25" x="10"><tspan id="SvgjsTspan1931" style="">private Node addWaiter(Node mode) {</tspan></tspan><tspan id="SvgjsTspan1932" dy="16.25" x="10"><tspan id="SvgjsTspan1933" style="">   Node node = new Node(Thread.currentThread(), mode);</tspan></tspan><tspan id="SvgjsTspan1934" dy="16.25" x="10"><tspan id="SvgjsTspan1935" style="">    // Try the fast path of enq; backup to full enq on failure</tspan></tspan><tspan id="SvgjsTspan1936" dy="16.25" x="10"><tspan id="SvgjsTspan1937" style="">    Node pred = tail;</tspan></tspan><tspan id="SvgjsTspan1938" dy="16.25" x="10"><tspan id="SvgjsTspan1939" style="">    if (pred != null) {</tspan></tspan><tspan id="SvgjsTspan1940" dy="16.25" x="10"><tspan id="SvgjsTspan1941" style="">        node.prev = pred;</tspan></tspan><tspan id="SvgjsTspan1942" dy="16.25" x="10"><tspan id="SvgjsTspan1943" style="">        if (compareAndSetTail(pred, node)) {</tspan></tspan><tspan id="SvgjsTspan1944" dy="16.25" x="10"><tspan id="SvgjsTspan1945" style="">            pred.next = node;</tspan></tspan><tspan id="SvgjsTspan1946" dy="16.25" x="10"><tspan id="SvgjsTspan1947" style="">            return node;</tspan></tspan><tspan id="SvgjsTspan1948" dy="16.25" x="10"><tspan id="SvgjsTspan1949" style="">        }</tspan></tspan><tspan id="SvgjsTspan1950" dy="16.25" x="10"><tspan id="SvgjsTspan1951" style="">    }</tspan></tspan><tspan id="SvgjsTspan1952" dy="16.25" x="10"><tspan id="SvgjsTspan1953" style="">    enq(node);</tspan></tspan><tspan id="SvgjsTspan1954" dy="16.25" x="10"><tspan id="SvgjsTspan1955" style="">    return node;</tspan></tspan><tspan id="SvgjsTspan1956" dy="16.25" x="10"><tspan id="SvgjsTspan1957" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1958" transform="translate(3781.6949115912225,665.5255855255858)"><path id="SvgjsPath1959" d="M 0 0L 232.78932178932246 0L 232.78932178932246 81.76190476190482L 0 81.76190476190482Z" stroke="none" fill-opacity="1" fill="#f9f469"></path><g id="SvgjsG1960"><text id="SvgjsText1961" font-family="微软雅黑" text-anchor="start" font-size="13px" width="213px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="-10.744047619047592" transform="rotate(0)"><tspan id="SvgjsTspan1962" dy="16.25" x="10"><tspan id="SvgjsTspan1963" style="">node.prev = pred;</tspan></tspan><tspan id="SvgjsTspan1964" dy="16.25" x="10"><tspan id="SvgjsTspan1965" style="">if (compareAndSetTail(pred, node))</tspan></tspan><tspan id="SvgjsTspan1966" dy="16.25" x="10"><tspan id="SvgjsTspan1967" style=""> {</tspan></tspan><tspan id="SvgjsTspan1968" dy="16.25" x="10"><tspan id="SvgjsTspan1969" style="">    pred.next = node;</tspan></tspan><tspan id="SvgjsTspan1970" dy="16.25" x="10"><tspan id="SvgjsTspan1971" style="">    return node;</tspan></tspan><tspan id="SvgjsTspan1972" dy="16.25" x="10"><tspan id="SvgjsTspan1973" style="">}</tspan></tspan></text></g></g><g id="SvgjsG1974" transform="translate(3770.9661958625065,760.1602075910167)"><path id="SvgjsPath1975" d="M 0 0L 101.04329004329065 0L 101.04329004329065 20L 0 20Z" stroke="none" fill-opacity="1" fill="#f9f469"></path><g id="SvgjsG1976"><text id="SvgjsText1977" font-family="微软雅黑" text-anchor="start" font-size="13px" width="82px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.625" transform="rotate(0)"><tspan id="SvgjsTspan1978" dy="16.25" x="10"><tspan id="SvgjsTspan1979" style="">enq(node);</tspan></tspan></text></g></g><g id="SvgjsG1980" transform="translate(3983.531852428165,728.8747918747916)"><path id="SvgjsPath1981" d="M 0 0L 30.158730158730123 0L 30.158730158730123 19.325098255907733L 0 19.325098255907733Z" stroke="none" fill="none"></path><g id="SvgjsG1982"><text id="SvgjsText1983" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="31px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.9624508720461336" transform="rotate(0)"><tspan id="SvgjsTspan1984" dy="16.25" x="15.5"><tspan id="SvgjsTspan1985" style="">❶</tspan></tspan></text></g></g><g id="SvgjsG1986" transform="translate(3852.0094859057976,760.8983028291121)"><path id="SvgjsPath1987" d="M 0 0L 20 0L 20 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1988"><text id="SvgjsText1989" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.625" transform="rotate(0)"><tspan id="SvgjsTspan1990" dy="16.25" x="10"><tspan id="SvgjsTspan1991" style="">❷</tspan></tspan></text></g></g><g id="SvgjsG1992" transform="translate(5018.228194733202,351.89466548710743)"><path id="SvgjsPath1993" d="M 0 0L 250 0L 250 65L 0 65Z" stroke="none" fill="none"></path><g id="SvgjsG1994"><text id="SvgjsText1995" font-family="微软雅黑" text-anchor="start" font-size="13px" width="250px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.375" transform="rotate(0)"><tspan id="SvgjsTspan1996" dy="16.25" x="0"><tspan id="SvgjsTspan1997" style="">这部分逻辑，是尝试获取锁失败的情况下，</tspan></tspan><tspan id="SvgjsTspan1998" dy="16.25" x="0"><tspan id="SvgjsTspan1999" style="">当前线程(尝试获取锁的)封装成 </tspan><tspan id="SvgjsTspan2000" style="font-style: italic;">Node</tspan><tspan id="SvgjsTspan2001" style=""> 对</tspan></tspan><tspan id="SvgjsTspan2002" dy="16.25" x="0"><tspan id="SvgjsTspan2003" style="">象，加入到 AQS 队列的处理逻辑</tspan></tspan></text></g></g><g id="SvgjsG2004" transform="translate(5154.591831096838,416.53738298466413)"><path id="SvgjsPath2005" d="M 0 0L 100 0L 100 68.5757575757575L 0 68.5757575757575Z" stroke="none" fill="none"></path><g id="SvgjsG2006"><text id="SvgjsText2007" font-family="微软雅黑" text-anchor="middle" font-size="60px" width="100px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="60px" weight="400" font-style="" opacity="1" y="-15.712121212121247" transform="rotate(0)"><tspan id="SvgjsTspan2008" dy="75" x="50"><tspan id="SvgjsTspan2009" style="font-weight: bold;">②</tspan></tspan></text></g></g><g id="SvgjsG2010"><path id="SvgjsPath2011" d="M4143.797305017999 695.4536187812638C 4205.134907047305 695.5652680652678 4185.109585275525 580.4881746340214 4247.188830370856 580.4881746340214" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2012" transform="translate(4247.188830370856,496.26244922785423)"><path id="SvgjsPath2013" d="M 0 0L 372.6363636363635 0L 388.6363636363635 16L 388.6363636363635 181.60563767482836L 0 181.60563767482836L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2014" d="M 372.6363636363635 0L 372.6363636363635 16L 388.6363636363635 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2015" d="M 0 0L 372.6363636363635 0L 388.6363636363635 16L 388.6363636363635 181.60563767482836L 0 181.60563767482836L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2016"><text id="SvgjsText2017" font-family="微软雅黑" text-anchor="start" font-size="13px" width="369px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.677818837414179" transform="rotate(0)"><tspan id="SvgjsTspan2018" dy="16.25" x="10"><tspan id="SvgjsTspan2019" style="">将当前线程封装成 </tspan><tspan id="SvgjsTspan2020" style="font-style: italic;">Node</tspan><tspan id="SvgjsTspan2021" style=""> 对象，并加入排队队列中</tspan></tspan><tspan id="SvgjsTspan2022" dy="16.25" x="10"><tspan id="SvgjsTspan2023" style=""> </tspan></tspan><tspan id="SvgjsTspan2024" dy="16.25" x="10"><tspan id="SvgjsTspan2025" style="">根据排队队列是否执行过初始化，执行❶、❷不同处理逻辑。</tspan></tspan><tspan id="SvgjsTspan2026" dy="16.25" x="10"><tspan id="SvgjsTspan2027" style=""> </tspan></tspan><tspan id="SvgjsTspan2028" dy="16.25" x="10"><tspan id="SvgjsTspan2029" style="">❶：表示排队队列不为空，即之前已经初始化过了，此时只需将</tspan></tspan><tspan id="SvgjsTspan2030" dy="16.25" x="10"><tspan id="SvgjsTspan2031" style="">新的 </tspan><tspan id="SvgjsTspan2032" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2033" style=""> 加入排队队列末尾即可</tspan></tspan><tspan id="SvgjsTspan2034" dy="16.25" x="10"><tspan id="SvgjsTspan2035" style=""> </tspan></tspan><tspan id="SvgjsTspan2036" dy="16.25" x="10"><tspan id="SvgjsTspan2037" style="">❷：表示排队队列为空，需要执行队列初始化。 </tspan><tspan id="SvgjsTspan2038" style="font-style: italic;">enq(node)</tspan><tspan id="SvgjsTspan2039" style=""> 会初</tspan></tspan><tspan id="SvgjsTspan2040" dy="16.25" x="10"><tspan id="SvgjsTspan2041" style="">始化一个空的 </tspan><tspan id="SvgjsTspan2042" style="font-style: italic;">Node</tspan><tspan id="SvgjsTspan2043" style="">，作为排队队列的 </tspan><tspan id="SvgjsTspan2044" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2045" style=""> ，然后将需要排队</tspan></tspan><tspan id="SvgjsTspan2046" dy="16.25" x="10"><tspan id="SvgjsTspan2047" style="">的线程，作为 </tspan><tspan id="SvgjsTspan2048" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2049" style=""> 的 </tspan><tspan id="SvgjsTspan2050" style="font-style: italic;">next</tspan><tspan id="SvgjsTspan2051" style=""> 节点插入</tspan></tspan></text></g></g><g id="SvgjsG2052"><path id="SvgjsPath2053" d="M3948.8810587773696 831.8152680652678L3948.8810587773696 932.2698135198137" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2054" transform="translate(3900.8810587773696,933.2891758449854)"><path id="SvgjsPath2055" d="M 0 35L 48 0L 96 35L 48 70Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2056"><text id="SvgjsText2057" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="24.725" transform="rotate(0)"><tspan id="SvgjsTspan2058" dy="16.25" x="48"><tspan id="SvgjsTspan2059" style="">pred != null</tspan></tspan></text></g></g><g id="SvgjsG2060"><path id="SvgjsPath2061" d="M3997.631058777372 968.2891758449854L4129.888273784586 968.2891758449854L4129.888273784586 1042.8050849358942" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2062)"></path><rect id="SvgjsRect2064" width="133" height="16" x="4063.388273784585" y="996.8172747374119" fill="#ffffff"></rect><text id="SvgjsText2065" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="133px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="994.1922747374119" transform="rotate(0)"><tspan id="SvgjsTspan2066" dy="16.25" x="4129.888273784585"><tspan id="SvgjsTspan2067" style="">false，执行上图步骤❷</tspan></tspan></text></g><g id="SvgjsG2068" transform="translate(4043.5246374209496,1045.5050849358943)"><path id="SvgjsPath2069" d="M 0 4Q 0 0 4 0L 168.72727272727252 0Q 172.72727272727252 0 172.72727272727252 4L 172.72727272727252 53.673819493010114Q 172.72727272727252 57.673819493010114 168.72727272727252 57.673819493010114L 4 57.673819493010114Q 0 57.673819493010114 0 53.673819493010114Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2070"><text id="SvgjsText2071" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="153px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.7119097465050572" transform="rotate(0)"><tspan id="SvgjsTspan2072" dy="16.25" x="86.5"><tspan id="SvgjsTspan2073" style="">没有其他线程在排队，调</tspan></tspan><tspan id="SvgjsTspan2074" dy="16.25" x="86.5"><tspan id="SvgjsTspan2075" style="">用 </tspan><tspan id="SvgjsTspan2076" style="font-style: italic;">enq(node)</tspan><tspan id="SvgjsTspan2077" style=""> 构造队列，</tspan></tspan><tspan id="SvgjsTspan2078" dy="16.25" x="86.5"><tspan id="SvgjsTspan2079" style="">并将 </tspan><tspan id="SvgjsTspan2080" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2081" style=""> 加入到队列</tspan></tspan></text></g></g><g id="SvgjsG2082"><path id="SvgjsPath2083" d="M3900.1310587773696 968.2891758449854L3792.8958495421607 968.2891758449854L3792.8958495421607 1046.153043375351" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2084)"></path><rect id="SvgjsRect2086" width="128" height="16" x="3728.8958495421607" y="996.9513936996223" fill="#ffffff"></rect><text id="SvgjsText2087" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="128px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="994.3263936996223" transform="rotate(0)"><tspan id="SvgjsTspan2088" dy="16.25" x="3792.8958495421607"><tspan id="SvgjsTspan2089" style="">true，执行上图步骤❶</tspan></tspan></text></g><g id="SvgjsG2090" transform="translate(3713.782213178524,1046.4937212995308)"><path id="SvgjsPath2091" d="M 0 4Q 0 0 4 0L 154.22727272727298 0Q 158.22727272727298 0 158.22727272727298 4L 158.22727272727298 51.69654676573737Q 158.22727272727298 55.69654676573737 154.22727272727298 55.69654676573737L 4 55.69654676573737Q 0 55.69654676573737 0 51.69654676573737Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2092"><text id="SvgjsText2093" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="139px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.7232733828686833" transform="rotate(0)"><tspan id="SvgjsTspan2094" dy="16.25" x="79.5"><tspan id="SvgjsTspan2095" style="">队列已经初始化，将 </tspan></tspan><tspan id="SvgjsTspan2096" dy="16.25" x="79.5"><tspan id="SvgjsTspan2097" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2098" style=""> 加入到队列末尾，</tspan></tspan><tspan id="SvgjsTspan2099" dy="16.25" x="79.5"><tspan id="SvgjsTspan2100" style="">加入后队列可能如下</tspan></tspan></text></g></g><g id="SvgjsG2101"><path id="SvgjsPath2102" d="M3792.8958495421607 1102.9402680652681L3792.8958495421607 1133.5141317016319L3792.8958495421607 1133.5141317016319L3792.8958495421607 1162.1379953379956" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2103)"></path></g><g id="SvgjsG2105" transform="translate(3744.8958495421607,1164.8379953379956)"><path id="SvgjsPath2106" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2107"><text id="SvgjsText2108" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2109" dy="16.25" x="48"><tspan id="SvgjsTspan2110" style="">返回 </tspan><tspan id="SvgjsTspan2111" style="font-style: italic;">node</tspan></tspan></text></g></g><g id="SvgjsG2112"><path id="SvgjsPath2113" d="M4129.888273784586 1103.9289044289046L4129.888273784586 1135.7033141754096L4129.888273784586 1135.7033141754096L4129.888273784586 1165.5277239219145" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2114)"></path></g><g id="SvgjsG2116" transform="translate(4081.888273784586,1164.8379953379956)"><path id="SvgjsPath2117" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2118"><text id="SvgjsText2119" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2120" dy="16.25" x="48"><tspan id="SvgjsTspan2121" style="">返回 </tspan><tspan id="SvgjsTspan2122" style="font-style: italic;">node</tspan></tspan></text></g></g><g id="SvgjsG2123"><path id="SvgjsPath2124" d="M4217.001910148222 1074.341994682399L4300.771343890212 1074.341994682399L4300.771343890212 1074.3419946824L4382.590777632202 1074.3419946824" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2125)"></path><rect id="SvgjsRect2127" width="52" height="16" x="4249.179680405627" y="1066.3419946823992" fill="#ffffff"></rect><text id="SvgjsText2128" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="52px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1063.7169946823992" transform="rotate(0)"><tspan id="SvgjsTspan2129" dy="16.25" x="4275.179680405627"><tspan id="SvgjsTspan2130" style="">enq 方法</tspan></tspan></text></g><g id="SvgjsG2131" transform="translate(4374.531130927443,934.5719497195513)"><path id="SvgjsPath2132" d="M 0 0L 302.9916512059376 0L 302.9916512059376 279.54008992569675L 0 279.54008992569675Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2133"><text id="SvgjsText2134" font-family="微软雅黑" text-anchor="start" font-size="13px" width="283px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="15.145044962848374" transform="rotate(0)"><tspan id="SvgjsTspan2135" dy="16.25" x="10"><tspan id="SvgjsTspan2136" style="">private Node enq(final Node node) {</tspan></tspan><tspan id="SvgjsTspan2137" dy="16.25" x="10"><tspan id="SvgjsTspan2138" style="">    for (;;) {</tspan></tspan><tspan id="SvgjsTspan2139" dy="16.25" x="10"><tspan id="SvgjsTspan2140" style="">        Node t = tail;</tspan></tspan><tspan id="SvgjsTspan2141" dy="16.25" x="10"><tspan id="SvgjsTspan2142" style="">        if (t == null) { // Must initialize</tspan></tspan><tspan id="SvgjsTspan2143" dy="16.25" x="10"><tspan id="SvgjsTspan2144" style="">            if (compareAndSetHead(Node()))</tspan></tspan><tspan id="SvgjsTspan2145" dy="16.25" x="10"><tspan id="SvgjsTspan2146" style="">                tail = head;</tspan></tspan><tspan id="SvgjsTspan2147" dy="16.25" x="10"><tspan id="SvgjsTspan2148" style="">        } else {</tspan></tspan><tspan id="SvgjsTspan2149" dy="16.25" x="10"><tspan id="SvgjsTspan2150" style="">            node.prev = t;</tspan></tspan><tspan id="SvgjsTspan2151" dy="16.25" x="10"><tspan id="SvgjsTspan2152" style="">            if (compareAndSetTail(t, node)) {</tspan></tspan><tspan id="SvgjsTspan2153" dy="16.25" x="10"><tspan id="SvgjsTspan2154" style="">                t.next = node;</tspan></tspan><tspan id="SvgjsTspan2155" dy="16.25" x="10"><tspan id="SvgjsTspan2156" style="">                return t;</tspan></tspan><tspan id="SvgjsTspan2157" dy="16.25" x="10"><tspan id="SvgjsTspan2158" style="">            }</tspan></tspan><tspan id="SvgjsTspan2159" dy="16.25" x="10"><tspan id="SvgjsTspan2160" style="">        }</tspan></tspan><tspan id="SvgjsTspan2161" dy="16.25" x="10"><tspan id="SvgjsTspan2162" style="">    }</tspan></tspan><tspan id="SvgjsTspan2163" dy="16.25" x="10"><tspan id="SvgjsTspan2164" style="">}</tspan></tspan></text></g></g><g id="SvgjsG2165"><path id="SvgjsPath2166" d="M4678.27278213338 1074.3419946823994L4756.662392522991 1074.3419946823994L4756.662392522991 1074.341994682399L4835.052002912601 1074.341994682399" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2167" transform="translate(4835.802002912601,821.0268123725203)"><path id="SvgjsPath2168" d="M 0 4Q 0 0 4 0L 392.590909090909 0Q 396.590909090909 0 396.590909090909 4L 396.590909090909 502.63036461975753Q 396.590909090909 506.63036461975753 392.590909090909 506.63036461975753L 4 506.63036461975753Q 0 506.63036461975753 0 502.63036461975753Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e9e9e9"></path><g id="SvgjsG2169"><text id="SvgjsText2170" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="377px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="242.69018230987876" transform="rotate(0)"></text></g></g><g id="SvgjsG2171" transform="translate(4839.211093821691,825.483357499268)"><path id="SvgjsPath2172" d="M 0 0L 415.909090909091 0L 415.909090909091 48.75L 0 48.75Z" stroke="none" fill="none"></path><g id="SvgjsG2173"><text id="SvgjsText2174" font-family="微软雅黑" text-anchor="start" font-size="13px" width="416px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.25" transform="rotate(0)"><tspan id="SvgjsTspan2175" dy="16.25" x="0"><tspan id="SvgjsTspan2176" style="">AQS 有两个属性 </tspan><tspan id="SvgjsTspan2177" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2178" style=""> 和 </tspan><tspan id="SvgjsTspan2179" style="font-style: italic;">tail</tspan><tspan id="SvgjsTspan2180" style="">，分别用来保持 AQS 队列的头尾节点。</tspan></tspan><tspan id="SvgjsTspan2181" dy="16.25" x="0"><tspan id="SvgjsTspan2182" style="">初始时，这两个属性都是 </tspan><tspan id="SvgjsTspan2183" style="font-style: italic;">null</tspan><tspan id="SvgjsTspan2184" style="">。当有一个线程排队，队列如下</tspan></tspan></text></g></g><g id="SvgjsG2185" transform="translate(5063.665639276237,934.7333574992684)"><path id="SvgjsPath2186" d="M 0 4Q 0 0 4 0L 116.72727272727298 0Q 120.72727272727298 0 120.72727272727298 4L 120.72727272727298 151.42381949301011Q 120.72727272727298 155.42381949301011 116.72727272727298 155.42381949301011L 4 155.42381949301011Q 0 155.42381949301011 0 151.42381949301011Z" stroke="none" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2187"><text id="SvgjsText2188" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="101px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.086909746505057" transform="rotate(0)"><tspan id="SvgjsTspan2189" dy="16.25" x="60.5"><tspan id="SvgjsTspan2190" style="">AQS队列(链表)</tspan></tspan><tspan id="SvgjsTspan2191" dy="16.25" x="60.5"><tspan id="SvgjsTspan2192" style=""> </tspan></tspan><tspan id="SvgjsTspan2193" dy="16.25" x="60.5"><tspan id="SvgjsTspan2194" style=""> </tspan></tspan><tspan id="SvgjsTspan2195" dy="16.25" x="60.5"><tspan id="SvgjsTspan2196" style=""> </tspan></tspan><tspan id="SvgjsTspan2197" dy="16.25" x="60.5"><tspan id="SvgjsTspan2198" style=""> </tspan></tspan><tspan id="SvgjsTspan2199" dy="16.25" x="60.5"><tspan id="SvgjsTspan2200" style=""> </tspan></tspan><tspan id="SvgjsTspan2201" dy="16.25" x="60.5"><tspan id="SvgjsTspan2202" style=""> </tspan></tspan><tspan id="SvgjsTspan2203" dy="16.25" x="60.5"><tspan id="SvgjsTspan2204" style=""> </tspan></tspan></text></g></g><g id="SvgjsG2205" transform="translate(5084.665639276237,976.7935406286423)"><path id="SvgjsPath2206" d="M 0 4Q 0 0 4 0L 75.81818181818198 0Q 79.81818181818198 0 79.81818181818198 4L 79.81818181818198 26.409090909090764Q 79.81818181818198 30.409090909090764 75.81818181818198 30.409090909090764L 4 30.409090909090764Q 0 30.409090909090764 0 26.409090909090764Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2207"><text id="SvgjsText2208" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="60px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="4.579545454545382" transform="rotate(0)"><tspan id="SvgjsTspan2209" dy="16.25" x="40"><tspan id="SvgjsTspan2210" style="">head</tspan></tspan></text></g></g><g id="SvgjsG2211" transform="translate(5084.665639276237,1034.7480860831877)"><path id="SvgjsPath2212" d="M 0 4Q 0 0 4 0L 75.81818181818198 0Q 79.81818181818198 0 79.81818181818198 4L 79.81818181818198 26.409090909090764Q 79.81818181818198 30.409090909090764 75.81818181818198 30.409090909090764L 4 30.409090909090764Q 0 30.409090909090764 0 26.409090909090764Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2213"><text id="SvgjsText2214" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="60px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="4.579545454545382" transform="rotate(0)"><tspan id="SvgjsTspan2215" dy="16.25" x="40"><tspan id="SvgjsTspan2216" style="">tail</tspan></tspan></text></g></g><g id="SvgjsG2217" transform="translate(4861.938366548963,1159.3844497195512)"><path id="SvgjsPath2218" d="M 0 4Q 0 0 4 0L 332.36363636363785 0Q 336.36363636363785 0 336.36363636363785 4L 336.36363636363785 131.31818181818176Q 336.36363636363785 135.31818181818176 332.36363636363785 135.31818181818176L 4 135.31818181818176Q 0 135.31818181818176 0 131.31818181818176Z" stroke="none" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2219"><text id="SvgjsText2220" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="317px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="57.03409090909088" transform="rotate(0)"></text></g></g><g id="SvgjsG2221" transform="translate(4887.802002912601,1172.2333574992683)"><path id="SvgjsPath2222" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 80.66708959789821Q 96 84.66708959789821 92 84.66708959789821L 4 84.66708959789821Q 0 84.66708959789821 0 80.66708959789821Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#fad8ea"></path><g id="SvgjsG2223"><text id="SvgjsText2224" font-family="微软雅黑" text-anchor="start" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.7914552010508942" transform="rotate(0)"><tspan id="SvgjsTspan2225" dy="16.25" x="10"><tspan id="SvgjsTspan2226" style="">Node : n1</tspan></tspan><tspan id="SvgjsTspan2227" dy="16.25" x="10"><tspan id="SvgjsTspan2228" style=""> </tspan></tspan><tspan id="SvgjsTspan2229" dy="16.25" x="10"><tspan id="SvgjsTspan2230" style="">thread = null</tspan></tspan><tspan id="SvgjsTspan2231" dy="16.25" x="10"><tspan id="SvgjsTspan2232" style="">prev = null</tspan></tspan><tspan id="SvgjsTspan2233" dy="16.25" x="10"><tspan id="SvgjsTspan2234" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG2235" transform="translate(5076.029275639873,1172.2333574992683)"><path id="SvgjsPath2236" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 80.66708959789821Q 96 84.66708959789821 92 84.66708959789821L 4 84.66708959789821Q 0 84.66708959789821 0 80.66708959789821Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2237"><text id="SvgjsText2238" font-family="微软雅黑" text-anchor="start" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.7914552010508942" transform="rotate(0)"><tspan id="SvgjsTspan2239" dy="16.25" x="10"><tspan id="SvgjsTspan2240" style="">Node : n2</tspan></tspan><tspan id="SvgjsTspan2241" dy="16.25" x="10"><tspan id="SvgjsTspan2242" style=""> </tspan></tspan><tspan id="SvgjsTspan2243" dy="16.25" x="10"><tspan id="SvgjsTspan2244" style="">thread = t2</tspan></tspan><tspan id="SvgjsTspan2245" dy="16.25" x="10"><tspan id="SvgjsTspan2246" style="">prev = n1</tspan></tspan><tspan id="SvgjsTspan2247" dy="16.25" x="10"><tspan id="SvgjsTspan2248" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG2249"><path id="SvgjsPath2250" d="M5075.279275639873 1214.5669022982172L5029.915639276237 1214.5669022982172L5029.915639276237 1214.5669022982172L4986.502002912601 1214.5669022982172" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2251)"></path><rect id="SvgjsRect2253" width="26" height="16" x="5018.831545533321" y="1206.5669022982172" fill="#ffffff"></rect><text id="SvgjsText2254" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1203.9419022982172" transform="rotate(0)"><tspan id="SvgjsTspan2255" dy="16.25" x="5031.831545533321"><tspan id="SvgjsTspan2256" style="">prev</tspan></tspan></text></g><g id="SvgjsG2257"><path id="SvgjsPath2258" d="M4935.802002912601 1257.6504470971665L4935.802002912601 1286.9004470971665L5124.029275639873 1286.9004470971665L5124.029275639873 1259.6004470971666" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2259)"></path><rect id="SvgjsRect2261" width="26" height="16" x="5015.021772019158" y="1278.9004470971668" fill="#ffffff"></rect><text id="SvgjsText2262" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1276.2754470971668" transform="rotate(0)"><tspan id="SvgjsTspan2263" dy="16.25" x="5028.021772019158"><tspan id="SvgjsTspan2264" style="">next</tspan></tspan></text></g><g id="SvgjsG2265"><path id="SvgjsPath2266" d="M5124.574730185329 1065.9071769922782L5124.574730185329 1118.6952672457733L5124.574730185329 1118.6952672457733L5124.574730185329 1169.5333574992683" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2267)"></path></g><g id="SvgjsG2269"><path id="SvgjsPath2270" d="M5083.915639276237 991.9980860831876L4935.802002912601 991.9980860831876L4935.802002912601 1169.5333574992683" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2271)"></path></g><g id="SvgjsG2273"><path id="SvgjsPath2274" d="M4526.206710808877 933.843809348899C 4526.0269565304125 898.6167259550577 4588.368733417119 905.7709685355953 4588.368733417119 869.8157447711018" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2275" transform="translate(4435.817713008957,760.8983028291121)"><path id="SvgjsPath2276" d="M 0 0L 289.1020408163258 0L 305.1020408163258 16L 305.1020408163258 108.91744194198941L 0 108.91744194198941L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2277" d="M 289.1020408163258 0L 289.1020408163258 16L 305.1020408163258 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2278" d="M 0 0L 289.1020408163258 0L 305.1020408163258 16L 305.1020408163258 108.91744194198941L 0 108.91744194198941L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2279"><text id="SvgjsText2280" font-family="微软雅黑" text-anchor="start" font-size="13px" width="286px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.8337209709947047" transform="rotate(0)"><tspan id="SvgjsTspan2281" dy="16.25" x="10"><tspan id="SvgjsTspan2282" style="">队列尚未初始化，调用这个 </tspan><tspan id="SvgjsTspan2283" style="font-style: italic;">enq</tspan><tspan id="SvgjsTspan2284" style=""> 方法。</tspan></tspan><tspan id="SvgjsTspan2285" dy="16.25" x="10"><tspan id="SvgjsTspan2286" style=""> </tspan></tspan><tspan id="SvgjsTspan2287" dy="16.25" x="10"><tspan id="SvgjsTspan2288" style="">该方法生成一个空的 </tspan><tspan id="SvgjsTspan2289" style="font-style: italic;">Node</tspan><tspan id="SvgjsTspan2290" style=""> 对象(</tspan><tspan id="SvgjsTspan2291" style="font-style: italic;">new Node()</tspan><tspan id="SvgjsTspan2292" style="">，右</tspan></tspan><tspan id="SvgjsTspan2293" dy="16.25" x="10"><tspan id="SvgjsTspan2294" style="">图粉色部分)，插入到 AQS 队列头部，然后将参</tspan></tspan><tspan id="SvgjsTspan2295" dy="16.25" x="10"><tspan id="SvgjsTspan2296" style="">数 </tspan><tspan id="SvgjsTspan2297" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2298" style="">，作为其后继节点，插入队列，方法执行</tspan></tspan><tspan id="SvgjsTspan2299" dy="16.25" x="10"><tspan id="SvgjsTspan2300" style="">完毕，队列如右图</tspan></tspan></text></g></g><g id="SvgjsG2301"><path id="SvgjsPath2302" d="M3872.7586687771036 1074.3769950444237C 3998.006022296621 1074.341994682399 4020.18038667315 1226.31115591687 4020.175160672721 1351.557710515301" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2303" transform="translate(3735.706455602767,1352.307692307693)"><path id="SvgjsPath2304" d="M 0 4Q 0 0 4 0L 554.8012780869926 0Q 558.8012780869926 0 558.8012780869926 4L 558.8012780869926 347.6464646464642Q 558.8012780869926 351.6464646464642 554.8012780869926 351.6464646464642L 4 351.6464646464642Q 0 351.6464646464642 0 347.6464646464642Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e9e9e9"></path><g id="SvgjsG2305"><text id="SvgjsText2306" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="539px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="165.1982323232321" transform="rotate(0)"></text></g></g><g id="SvgjsG2307" transform="translate(3954.719957973412,1361.9994933053033)"><path id="SvgjsPath2308" d="M 0 4Q 0 0 4 0L 116.72727272727298 0Q 120.72727272727298 0 120.72727272727298 4L 120.72727272727298 151.42381949301011Q 120.72727272727298 155.42381949301011 116.72727272727298 155.42381949301011L 4 155.42381949301011Q 0 155.42381949301011 0 151.42381949301011Z" stroke="none" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2309"><text id="SvgjsText2310" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="101px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.086909746505057" transform="rotate(0)"><tspan id="SvgjsTspan2311" dy="16.25" x="60.5"><tspan id="SvgjsTspan2312" style="">AQS队列(链表)</tspan></tspan><tspan id="SvgjsTspan2313" dy="16.25" x="60.5"><tspan id="SvgjsTspan2314" style=""> </tspan></tspan><tspan id="SvgjsTspan2315" dy="16.25" x="60.5"><tspan id="SvgjsTspan2316" style=""> </tspan></tspan><tspan id="SvgjsTspan2317" dy="16.25" x="60.5"><tspan id="SvgjsTspan2318" style=""> </tspan></tspan><tspan id="SvgjsTspan2319" dy="16.25" x="60.5"><tspan id="SvgjsTspan2320" style=""> </tspan></tspan><tspan id="SvgjsTspan2321" dy="16.25" x="60.5"><tspan id="SvgjsTspan2322" style=""> </tspan></tspan><tspan id="SvgjsTspan2323" dy="16.25" x="60.5"><tspan id="SvgjsTspan2324" style=""> </tspan></tspan><tspan id="SvgjsTspan2325" dy="16.25" x="60.5"><tspan id="SvgjsTspan2326" style=""> </tspan></tspan></text></g></g><g id="SvgjsG2327" transform="translate(3975.719957973412,1404.0596764346772)"><path id="SvgjsPath2328" d="M 0 4Q 0 0 4 0L 75.81818181818198 0Q 79.81818181818198 0 79.81818181818198 4L 79.81818181818198 26.409090909090764Q 79.81818181818198 30.409090909090764 75.81818181818198 30.409090909090764L 4 30.409090909090764Q 0 30.409090909090764 0 26.409090909090764Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2329"><text id="SvgjsText2330" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="60px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="4.579545454545382" transform="rotate(0)"><tspan id="SvgjsTspan2331" dy="16.25" x="40"><tspan id="SvgjsTspan2332" style="">head</tspan></tspan></text></g></g><g id="SvgjsG2333" transform="translate(3975.719957973412,1462.0142218892227)"><path id="SvgjsPath2334" d="M 0 4Q 0 0 4 0L 75.81818181818198 0Q 79.81818181818198 0 79.81818181818198 4L 79.81818181818198 26.409090909090764Q 79.81818181818198 30.409090909090764 75.81818181818198 30.409090909090764L 4 30.409090909090764Q 0 30.409090909090764 0 26.409090909090764Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2335"><text id="SvgjsText2336" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="60px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="4.579545454545382" transform="rotate(0)"><tspan id="SvgjsTspan2337" dy="16.25" x="40"><tspan id="SvgjsTspan2338" style="">tail</tspan></tspan></text></g></g><g id="SvgjsG2339" transform="translate(3744.8958495421607,1542.7177830528851)"><path id="SvgjsPath2340" d="M 0 4Q 0 0 4 0L 332.36363636363785 0Q 336.36363636363785 0 336.36363636363785 4L 336.36363636363785 131.31818181818176Q 336.36363636363785 135.31818181818176 332.36363636363785 135.31818181818176L 4 135.31818181818176Q 0 135.31818181818176 0 131.31818181818176Z" stroke="none" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2341"><text id="SvgjsText2342" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="317px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="57.03409090909088" transform="rotate(0)"></text></g></g><g id="SvgjsG2343" transform="translate(3770.7594859057986,1556.0652680652686)"><path id="SvgjsPath2344" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 80.66708959789821Q 96 84.66708959789821 92 84.66708959789821L 4 84.66708959789821Q 0 84.66708959789821 0 80.66708959789821Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#fad8ea"></path><g id="SvgjsG2345"><text id="SvgjsText2346" font-family="微软雅黑" text-anchor="start" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.7914552010508942" transform="rotate(0)"><tspan id="SvgjsTspan2347" dy="16.25" x="10"><tspan id="SvgjsTspan2348" style="">Node : n1</tspan></tspan><tspan id="SvgjsTspan2349" dy="16.25" x="10"><tspan id="SvgjsTspan2350" style=""> </tspan></tspan><tspan id="SvgjsTspan2351" dy="16.25" x="10"><tspan id="SvgjsTspan2352" style="">thread = null</tspan></tspan><tspan id="SvgjsTspan2353" dy="16.25" x="10"><tspan id="SvgjsTspan2354" style="">prev = null</tspan></tspan><tspan id="SvgjsTspan2355" dy="16.25" x="10"><tspan id="SvgjsTspan2356" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG2357" transform="translate(3958.9867586330715,1556.0652680652686)"><path id="SvgjsPath2358" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 80.66708959789821Q 96 84.66708959789821 92 84.66708959789821L 4 84.66708959789821Q 0 84.66708959789821 0 80.66708959789821Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2359"><text id="SvgjsText2360" font-family="微软雅黑" text-anchor="start" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.7914552010508942" transform="rotate(0)"><tspan id="SvgjsTspan2361" dy="16.25" x="10"><tspan id="SvgjsTspan2362" style="">Node : n2</tspan></tspan><tspan id="SvgjsTspan2363" dy="16.25" x="10"><tspan id="SvgjsTspan2364" style=""> </tspan></tspan><tspan id="SvgjsTspan2365" dy="16.25" x="10"><tspan id="SvgjsTspan2366" style="">thread = t2</tspan></tspan><tspan id="SvgjsTspan2367" dy="16.25" x="10"><tspan id="SvgjsTspan2368" style="">prev = n1</tspan></tspan><tspan id="SvgjsTspan2369" dy="16.25" x="10"><tspan id="SvgjsTspan2370" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG2371" transform="translate(4164.542314188627,1556.0652680652686)"><path id="SvgjsPath2372" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 80.66708959789821Q 96 84.66708959789821 92 84.66708959789821L 4 84.66708959789821Q 0 84.66708959789821 0 80.66708959789821Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2373"><text id="SvgjsText2374" font-family="微软雅黑" text-anchor="start" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.7914552010508942" transform="rotate(0)"><tspan id="SvgjsTspan2375" dy="16.25" x="10"><tspan id="SvgjsTspan2376" style="">Node : n2</tspan></tspan><tspan id="SvgjsTspan2377" dy="16.25" x="10"><tspan id="SvgjsTspan2378" style=""> </tspan></tspan><tspan id="SvgjsTspan2379" dy="16.25" x="10"><tspan id="SvgjsTspan2380" style="">thread = t2</tspan></tspan><tspan id="SvgjsTspan2381" dy="16.25" x="10"><tspan id="SvgjsTspan2382" style="">prev = n1</tspan></tspan><tspan id="SvgjsTspan2383" dy="16.25" x="10"><tspan id="SvgjsTspan2384" style="">next = null</tspan></tspan></text></g></g><g id="SvgjsG2385"><path id="SvgjsPath2386" d="M3974.969957973412 1419.2642218892222L3740.7594859057986 1419.2642218892222L3740.7594859057986 1598.398812864218L3768.0594859057987 1598.398812864218" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2387)"></path></g><g id="SvgjsG2389"><path id="SvgjsPath2390" d="M4056.288139791594 1477.2187673437677L4212.542314188627 1477.2187673437677L4212.542314188627 1553.3652680652685" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2391)"></path></g><g id="SvgjsG2393"><path id="SvgjsPath2394" d="M4163.792314188627 1598.398812864218L4109.764536410849 1598.398812864218L4109.764536410849 1598.398812864218L4057.6867586330713 1598.398812864218" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2395)"></path><rect id="SvgjsRect2397" width="26" height="16" x="4096.929999740903" y="1590.398812864218" fill="#ffffff"></rect><text id="SvgjsText2398" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1587.773812864218" transform="rotate(0)"><tspan id="SvgjsTspan2399" dy="16.25" x="4109.929999740903"><tspan id="SvgjsTspan2400" style="">prev</tspan></tspan></text></g><g id="SvgjsG2401"><path id="SvgjsPath2402" d="M3958.2367586330715 1598.398812864218L3912.8731222694355 1598.398812864218L3912.8731222694355 1598.398812864218L3869.4594859057993 1598.398812864218" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2403)"></path><rect id="SvgjsRect2405" width="26" height="16" x="3901.329418474462" y="1590.3988128642181" fill="#ffffff"></rect><text id="SvgjsText2406" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1587.7738128642181" transform="rotate(0)"><tspan id="SvgjsTspan2407" dy="16.25" x="3914.329418474462"><tspan id="SvgjsTspan2408" style="">prev</tspan></tspan></text></g><g id="SvgjsG2409"><path id="SvgjsPath2410" d="M3819.2312765040006 1641.315378787525C 3863.3731222694337 1703.9541569541568 3964.484233380545 1707.2874902874908 4005.377991704844 1642.9007370051274" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2411)"></path><rect id="SvgjsRect2413" width="26" height="16" x="3899.027706826356" y="1681.707868320704" fill="#ffffff"></rect><text id="SvgjsText2414" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1679.082868320704" transform="rotate(0)"><tspan id="SvgjsTspan2415" dy="16.25" x="3912.027706826356"><tspan id="SvgjsTspan2416" style="">next</tspan></tspan></text></g><g id="SvgjsG2417"><path id="SvgjsPath2418" d="M4007.4373201474905 1641.3319361165193C 4048.9286778249902 1706.1763791763794 4171.1509000472115 1709.5097125097125 4210.977502436422 1642.932667682269" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2419)"></path><rect id="SvgjsRect2421" width="26" height="16" x="4095.0403340704615" y="1683.3776353416658" fill="#ffffff"></rect><text id="SvgjsText2422" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1680.7526353416658" transform="rotate(0)"><tspan id="SvgjsTspan2423" dy="16.25" x="4108.0403340704615"><tspan id="SvgjsTspan2424" style="">next</tspan></tspan></text></g><g id="SvgjsG2425"><path id="SvgjsPath2426" d="M4295.246604324698 1528.2596498608784C 4332.5571793124045 1528.1309246309254 4336.481685304799 1579.558133827334 4374.531130927443 1579.558133827334" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2427" transform="translate(4374.531130927443,1542.7177830528851)"><path id="SvgjsPath2428" d="M 0 0L 152.8888888888887 0L 168.8888888888887 16L 168.8888888888887 68.97033373522572L 0 68.97033373522572L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2429" d="M 152.8888888888887 0L 152.8888888888887 16L 168.8888888888887 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2430" d="M 0 0L 152.8888888888887 0L 168.8888888888887 16L 168.8888888888887 68.97033373522572L 0 68.97033373522572L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2431"><text id="SvgjsText2432" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="149px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.6398331323871389" transform="rotate(0)"><tspan id="SvgjsTspan2433" dy="16.25" x="84.5"><tspan id="SvgjsTspan2434" style="">这个队列表示，在节点 </tspan></tspan><tspan id="SvgjsTspan2435" dy="16.25" x="84.5"><tspan id="SvgjsTspan2436" style="font-style: italic;">n3</tspan><tspan id="SvgjsTspan2437" style=""> 插入之前，已经有一</tspan></tspan><tspan id="SvgjsTspan2438" dy="16.25" x="84.5"><tspan id="SvgjsTspan2439" style="">个节点 </tspan><tspan id="SvgjsTspan2440" style="font-style: italic;">n2</tspan><tspan id="SvgjsTspan2441" style="">，在排队获取</tspan></tspan><tspan id="SvgjsTspan2442" dy="16.25" x="84.5"><tspan id="SvgjsTspan2443" style="">锁了</tspan></tspan></text></g></g><g id="SvgjsG2444"><path id="SvgjsPath2445" d="M2883.193181818182 1113.4166666666667L2883.193181818182 1217.3303030303032" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2446)"></path></g><g id="SvgjsG2448" transform="translate(2716.107954545455,1220.0303030303032)"><path id="SvgjsPath2449" d="M 0 4Q 0 0 4 0L 330.1704545454545 0Q 334.1704545454545 0 334.1704545454545 4L 334.1704545454545 43.27272727272725Q 334.1704545454545 47.27272727272725 330.1704545454545 47.27272727272725L 4 47.27272727272725Q 0 47.27272727272725 0 43.27272727272725Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2450"><text id="SvgjsText2451" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="315px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="13.011363636363626" transform="rotate(0)"><tspan id="SvgjsTspan2452" dy="16.25" x="167.5"><tspan id="SvgjsTspan2453" style="">acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</tspan></tspan></text></g></g><g id="SvgjsG2454"><path id="SvgjsPath2455" d="M5034.317524014551 1328.3741642381292C 5034.097457458057 1360.492437576115 5096.58711695822 1348.0526130562073 5096.58711695822 1380.8878736400436" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2456" transform="translate(4994.8722310038365,1380.8878736400436)"><path id="SvgjsPath2457" d="M 0 0L 187.42977190876445 0L 203.42977190876445 16L 203.42977190876445 67.70680618993106L 0 67.70680618993106L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2458" d="M 187.42977190876445 0L 187.42977190876445 16L 203.42977190876445 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2459" d="M 0 0L 187.42977190876445 0L 203.42977190876445 16L 203.42977190876445 67.70680618993106L 0 67.70680618993106L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2460"><text id="SvgjsText2461" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="184px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="14.728403094965529" transform="rotate(0)"><tspan id="SvgjsTspan2462" dy="16.25" x="102"><tspan id="SvgjsTspan2463" style="">这个队列表示，在节点 </tspan><tspan id="SvgjsTspan2464" style="font-style: italic;">n2</tspan><tspan id="SvgjsTspan2465" style=""> 插入</tspan></tspan><tspan id="SvgjsTspan2466" dy="16.25" x="102"><tspan id="SvgjsTspan2467" style="">之前，只有一个占位头节点</tspan></tspan></text></g></g><g id="SvgjsG2468" transform="translate(2210.848484848485,1842.7525596833698)"><path id="SvgjsPath2469" d="M 0 0L 1600.5916645186435 0L 1600.5916645186435 1353.4947521445872L 0 1353.4947521445872Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#fbe9d0"></path><g id="SvgjsG2470"><text id="SvgjsText2471" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1581px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="666.1223760722936" transform="rotate(0)"></text></g></g><g id="SvgjsG2472" transform="translate(2307.8055555555566,1842.7525596833696)"><path id="SvgjsPath2473" d="M 0 0L 244.79166666666606 0L 244.79166666666606 72.73442555361635L 0 72.73442555361635Z" stroke="none" fill="none"></path><g id="SvgjsG2474"><text id="SvgjsText2475" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="245px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.242212776808174" transform="rotate(0)"><tspan id="SvgjsTspan2476" dy="16.25" x="122.5"><tspan id="SvgjsTspan2477" style="">这部分，是 node 加入队列后的处理逻</tspan></tspan><tspan id="SvgjsTspan2478" dy="16.25" x="122.5"><tspan id="SvgjsTspan2479" style="">辑，这里会有一次自旋，尝试获取锁，获</tspan></tspan><tspan id="SvgjsTspan2480" dy="16.25" x="122.5"><tspan id="SvgjsTspan2481" style="">取不到，才调用 park，阻塞自己</tspan></tspan></text></g></g><g id="SvgjsG2482" transform="translate(2312.021464646465,1905.97435897436)"><path id="SvgjsPath2483" d="M 0 0L 100 0L 100 59.58333333333326L 0 59.58333333333326Z" stroke="none" fill="none"></path><g id="SvgjsG2484"><text id="SvgjsText2485" font-family="微软雅黑" text-anchor="middle" font-size="60px" width="100px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="60px" weight="400" font-style="" opacity="1" y="-20.20833333333337" transform="rotate(0)"><tspan id="SvgjsTspan2486" dy="75" x="50"><tspan id="SvgjsTspan2487" style="font-weight: bold;">③</tspan></tspan></text></g></g><g id="SvgjsG2488"><path id="SvgjsPath2489" d="M2883.193181818182 1268.0530303030305C 2883.193181818182 1289.5481129981135 2883.1931818181824 1300.6706543456553 2883.1931818181824 1320.2157370407383" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2490)"></path></g><g id="SvgjsG2492" transform="translate(2759.5606060606065,1322.9157370407383)"><path id="SvgjsPath2493" d="M 0 4Q 0 0 4 0L 243.2651515151515 0Q 247.2651515151515 0 247.2651515151515 4L 247.2651515151515 31.416666666666742Q 247.2651515151515 35.41666666666674 243.2651515151515 35.41666666666674L 4 35.41666666666674Q 0 35.41666666666674 0 31.416666666666742Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG2494"><text id="SvgjsText2495" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="228px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.4166666666666288" transform="rotate(0)"><tspan id="SvgjsTspan2496" dy="16.25" x="124"><tspan id="SvgjsTspan2497" style="font-style: italic;">acquireQueued</tspan><tspan id="SvgjsTspan2498" style=""> 返回，表示线程获取到</tspan></tspan><tspan id="SvgjsTspan2499" dy="16.25" x="124"><tspan id="SvgjsTspan2500" style="">锁，线程逐级返回，加锁过程结束。</tspan></tspan></text></g></g><g id="SvgjsG2501" transform="translate(2240.916666666667,1970.0966255966284)"><path id="SvgjsPath2502" d="M 0 244.25631313131302L 244.25631313131302 0L 1221.2815656565651 0L 1465.537878787878 244.25631313131302L 1465.537878787878 1121.7518592518563L 0 1121.7518592518563L 0 244.25631313131302Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7ebed"></path><g id="SvgjsG2503"><text id="SvgjsText2504" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1446px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="550.2509296259282" transform="rotate(0)"></text></g></g><g id="SvgjsG2505"><path id="SvgjsPath2506" d="M2715.3612624641364 1243.7370295524515C 2625.107077900723 1243.6666666666667 2643.5980988669544 1401.848484848485 2553.343914303541 1401.7781219627002" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect2507" width="152" height="16" x="2556.1979535526343" y="1319.4983873815597" fill="#ffffff"></rect><text id="SvgjsText2508" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="152px" fill="#a7932c" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1316.8733873815597" transform="rotate(0)"><tspan id="SvgjsTspan2509" dy="16.25" x="2632.1979535526343"><tspan id="SvgjsTspan2510" style="">执行 acquireQueued 逻辑</tspan></tspan></text></g><g id="SvgjsG2511" transform="translate(2194.6426767676767,1220.0303030303032)"><path id="SvgjsPath2512" d="M 0 0L 357.95454545454595 0L 357.95454545454595 363.6363636363635L 0 363.6363636363635Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2513"><text id="SvgjsText2514" font-family="微软雅黑" text-anchor="start" font-size="13px" width="338px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="8.693181818181756" transform="rotate(0)"><tspan id="SvgjsTspan2515" dy="16.25" x="10"><tspan id="SvgjsTspan2516" style="">final boolean acquireQueued(final Node node, int arg) {</tspan></tspan><tspan id="SvgjsTspan2517" dy="16.25" x="10"><tspan id="SvgjsTspan2518" style="">    boolean failed = true;</tspan></tspan><tspan id="SvgjsTspan2519" dy="16.25" x="10"><tspan id="SvgjsTspan2520" style="">    try {</tspan></tspan><tspan id="SvgjsTspan2521" dy="16.25" x="10"><tspan id="SvgjsTspan2522" style="">        boolean interrupted = false;</tspan></tspan><tspan id="SvgjsTspan2523" dy="16.25" x="10"><tspan id="SvgjsTspan2524" style="">        for (;;) {</tspan></tspan><tspan id="SvgjsTspan2525" dy="16.25" x="10"><tspan id="SvgjsTspan2526" style="">            final Node p = node.predecessor();</tspan></tspan><tspan id="SvgjsTspan2527" dy="16.25" x="10"><tspan id="SvgjsTspan2528" style="">            if (p == head &amp;&amp; tryAcquire(arg)) {</tspan></tspan><tspan id="SvgjsTspan2529" dy="16.25" x="10"><tspan id="SvgjsTspan2530" style="">                setHead(node);</tspan></tspan><tspan id="SvgjsTspan2531" dy="16.25" x="10"><tspan id="SvgjsTspan2532" style="">                p.next = null; // help GC</tspan></tspan><tspan id="SvgjsTspan2533" dy="16.25" x="10"><tspan id="SvgjsTspan2534" style="">                failed = false;</tspan></tspan><tspan id="SvgjsTspan2535" dy="16.25" x="10"><tspan id="SvgjsTspan2536" style="">                return interrupted;</tspan></tspan><tspan id="SvgjsTspan2537" dy="16.25" x="10"><tspan id="SvgjsTspan2538" style="">            }</tspan></tspan><tspan id="SvgjsTspan2539" dy="16.25" x="10"><tspan id="SvgjsTspan2540" style="">            if (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</tspan></tspan><tspan id="SvgjsTspan2541" dy="16.25" x="10"><tspan id="SvgjsTspan2542" style="">                    parkAndCheckInterrupt())</tspan></tspan><tspan id="SvgjsTspan2543" dy="16.25" x="10"><tspan id="SvgjsTspan2544" style="">                interrupted = true;</tspan></tspan><tspan id="SvgjsTspan2545" dy="16.25" x="10"><tspan id="SvgjsTspan2546" style="">        }</tspan></tspan><tspan id="SvgjsTspan2547" dy="16.25" x="10"><tspan id="SvgjsTspan2548" style="">    } finally {</tspan></tspan><tspan id="SvgjsTspan2549" dy="16.25" x="10"><tspan id="SvgjsTspan2550" style="">        if (failed)</tspan></tspan><tspan id="SvgjsTspan2551" dy="16.25" x="10"><tspan id="SvgjsTspan2552" style="">            cancelAcquire(node);</tspan></tspan><tspan id="SvgjsTspan2553" dy="16.25" x="10"><tspan id="SvgjsTspan2554" style="">    }</tspan></tspan><tspan id="SvgjsTspan2555" dy="16.25" x="10"><tspan id="SvgjsTspan2556" style="">}</tspan></tspan></text></g></g><g id="SvgjsG2557"><path id="SvgjsPath2558" d="M2373.4041920108807 1219.3120073334846C 2373.6199494949497 1192.5394871999677 2329.133686868687 1195.1343036643882 2329.133686868687 1167.6434878340526" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2559" transform="translate(2166.0303030303035,840.7121212121212)"><path id="SvgjsPath2560" d="M 0 0L 300.33333333333303 0L 316.33333333333303 16L 316.33333333333303 332.9545454545455L 0 332.9545454545455L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2561" d="M 300.33333333333303 0L 300.33333333333303 16L 316.33333333333303 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2562" d="M 0 0L 300.33333333333303 0L 316.33333333333303 16L 316.33333333333303 332.9545454545455L 0 332.9545454545455L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2563"><text id="SvgjsText2564" font-family="微软雅黑" text-anchor="start" font-size="13px" width="297px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.352272727272748" transform="rotate(0)"><tspan id="SvgjsTspan2565" dy="16.25" x="10"><tspan id="SvgjsTspan2566" style="">整个 AQS 的核心和难点之一。</tspan></tspan><tspan id="SvgjsTspan2567" dy="16.25" x="10"><tspan id="SvgjsTspan2568" style="">注意这里使用 </tspan><tspan id="SvgjsTspan2569" style="font-style: italic;">for(;;)</tspan></tspan><tspan id="SvgjsTspan2570" dy="16.25" x="10"><tspan id="SvgjsTspan2571" style=""> </tspan></tspan><tspan id="SvgjsTspan2572" dy="16.25" x="10"><tspan id="SvgjsTspan2573" style="">首先判断 </tspan><tspan id="SvgjsTspan2574" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2575" style=""> 的前驱节点，是不是 </tspan><tspan id="SvgjsTspan2576" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2577" style="">，如果</tspan></tspan><tspan id="SvgjsTspan2578" dy="16.25" x="10"><tspan id="SvgjsTspan2579" style="">是，说明它是下一个可以获得锁的线程，则调用一</tspan></tspan><tspan id="SvgjsTspan2580" dy="16.25" x="10"><tspan id="SvgjsTspan2581" style="">次 </tspan><tspan id="SvgjsTspan2582" style="font-style: italic;">tryAcquire</tspan><tspan id="SvgjsTspan2583" style="">，尝试获取锁，若获取到，则将链表</tspan></tspan><tspan id="SvgjsTspan2584" dy="16.25" x="10"><tspan id="SvgjsTspan2585" style="">关系重新维护下(</tspan><tspan id="SvgjsTspan2586" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2587" style=""> 设置为 </tspan><tspan id="SvgjsTspan2588" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2589" style="">，之前的 </tspan><tspan id="SvgjsTspan2590" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2591" style=""> </tspan></tspan><tspan id="SvgjsTspan2592" dy="16.25" x="10"><tspan id="SvgjsTspan2593" style="">从链表移出)，然后返回</tspan></tspan><tspan id="SvgjsTspan2594" dy="16.25" x="10"><tspan id="SvgjsTspan2595" style=""> </tspan></tspan><tspan id="SvgjsTspan2596" dy="16.25" x="10"><tspan id="SvgjsTspan2597" style="">如果 </tspan><tspan id="SvgjsTspan2598" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2599" style=""> 的前驱节点不是 </tspan><tspan id="SvgjsTspan2600" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2601" style="">，或获取锁失败，</tspan></tspan><tspan id="SvgjsTspan2602" dy="16.25" x="10"><tspan id="SvgjsTspan2603" style="">再判断其前驱节点的 </tspan><tspan id="SvgjsTspan2604" style="font-style: italic;">waitState</tspan><tspan id="SvgjsTspan2605" style="">，是不是 </tspan><tspan id="SvgjsTspan2606" style="font-style: italic;">SIGNAL</tspan><tspan id="SvgjsTspan2607" style="">，</tspan></tspan><tspan id="SvgjsTspan2608" dy="16.25" x="10"><tspan id="SvgjsTspan2609" style="">如果是，则当前线程调用 </tspan><tspan id="SvgjsTspan2610" style="font-style: italic;">park</tspan><tspan id="SvgjsTspan2611" style="">，进入阻塞状态。</tspan></tspan><tspan id="SvgjsTspan2612" dy="16.25" x="10"><tspan id="SvgjsTspan2613" style="">如不是：</tspan></tspan><tspan id="SvgjsTspan2614" dy="16.25" x="10"><tspan id="SvgjsTspan2615" style="">1. </tspan><tspan id="SvgjsTspan2616" style="font-style: italic;">== 0</tspan><tspan id="SvgjsTspan2617" style="">，则设置为 </tspan><tspan id="SvgjsTspan2618" style="font-style: italic;">SIGNAL</tspan><tspan id="SvgjsTspan2619" style="">；</tspan></tspan><tspan id="SvgjsTspan2620" dy="16.25" x="10"><tspan id="SvgjsTspan2621" style="">2. </tspan><tspan id="SvgjsTspan2622" style="font-style: italic;">&gt; 0</tspan><tspan id="SvgjsTspan2623" style=""> (</tspan><tspan id="SvgjsTspan2624" style="font-style: italic;">== 1</tspan><tspan id="SvgjsTspan2625" style="">)；则表示前驱节点已经被取消了，将取</tspan></tspan><tspan id="SvgjsTspan2626" dy="16.25" x="10"><tspan id="SvgjsTspan2627" style="">消的节点，从队列移出，重新维护下队列链表关</tspan></tspan><tspan id="SvgjsTspan2628" dy="16.25" x="10"><tspan id="SvgjsTspan2629" style="">系。</tspan></tspan><tspan id="SvgjsTspan2630" dy="16.25" x="10"><tspan id="SvgjsTspan2631" style=""> </tspan></tspan><tspan id="SvgjsTspan2632" dy="16.25" x="10"><tspan id="SvgjsTspan2633" style="">然后再次进入 </tspan><tspan id="SvgjsTspan2634" style="font-style: italic;">for</tspan><tspan id="SvgjsTspan2635" style=""> 循环，上面的逻辑重新执行一</tspan></tspan><tspan id="SvgjsTspan2636" dy="16.25" x="10"><tspan id="SvgjsTspan2637" style="">遍。</tspan></tspan></text></g></g><g id="SvgjsG2638" transform="translate(2548.030303030303,2136.96867592661)"><path id="SvgjsPath2639" d="M 0 44.34899537002843L 78.4848484848485 0L 156.969696969697 44.34899537002843L 78.4848484848485 88.69799074005687Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2640"><text id="SvgjsText2641" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="137px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.66748532372872" transform="rotate(0)"><tspan id="SvgjsTspan2642" dy="16.25" x="78.5"><tspan id="SvgjsTspan2643" style="font-style: italic;">p == head</tspan><tspan id="SvgjsTspan2644" style=""> ? </tspan></tspan><tspan id="SvgjsTspan2645" dy="16.25" x="78.5"><tspan id="SvgjsTspan2646" style="">表示查询 </tspan><tspan id="SvgjsTspan2647" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2648" style=""> 是不是</tspan></tspan><tspan id="SvgjsTspan2649" dy="16.25" x="78.5"><tspan id="SvgjsTspan2650" style="">第一个排队的</tspan></tspan></text></g></g><g id="SvgjsG2651"><path id="SvgjsPath2652" d="M2626.5151515151515 2226.416666666667L2626.5151515151515 2272.966666666667" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2653)"></path><rect id="SvgjsRect2655" width="24" height="16" x="2614.515151515152" y="2238.560121212122" fill="#ffffff"></rect><text id="SvgjsText2656" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2235.935121212122" transform="rotate(0)"><tspan id="SvgjsTspan2657" dy="16.25" x="2626.515151515152"><tspan id="SvgjsTspan2658" style="">true</tspan></tspan></text></g><g id="SvgjsG2659" transform="translate(2578.5151515151515,2275.666666666667)"><path id="SvgjsPath2660" d="M 0 24.658251006783303L 48 0L 96 24.658251006783303L 48 49.316502013566605Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2661"><text id="SvgjsText2662" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="14.279833516851134" transform="rotate(0)"><tspan id="SvgjsTspan2663" dy="16.25" x="48"><tspan id="SvgjsTspan2664" style="">tryAcquire</tspan></tspan></text></g></g><g id="SvgjsG2665"><path id="SvgjsPath2666" d="M2705.75 2181.3176712966388L2765.6183712121215 2181.3176712966388L2765.6183712121215 2384.214807414811" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2667)"></path><rect id="SvgjsRect2669" width="29" height="16" x="2751.1183712121215" y="2276.0993224680424" fill="#ffffff"></rect><text id="SvgjsText2670" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2273.4743224680424" transform="rotate(0)"><tspan id="SvgjsTspan2671" dy="16.25" x="2765.6183712121215"><tspan id="SvgjsTspan2672" style="">false</tspan></tspan></text></g><g id="SvgjsG2673" transform="translate(2635.070075757576,2386.9148074148106)"><path id="SvgjsPath2674" d="M 0 31.375929625928165L 130.5482954545455 0L 261.096590909091 31.375929625928165L 130.5482954545455 62.75185925185633Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2675"><text id="SvgjsText2676" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="242px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="21.064688922187447" transform="rotate(0)"><tspan id="SvgjsTspan2677" dy="16.25" x="131"><tspan id="SvgjsTspan2678" style="">shouldParkAfterFailedAcquire(p, node)</tspan></tspan></text></g></g><g id="SvgjsG2679" transform="translate(2544.818181818182,2035.3615942774625)"><path id="SvgjsPath2680" d="M 0 4Q 0 0 4 0L 159.39393939393904 0Q 163.39393939393904 0 163.39393939393904 4L 163.39393939393904 47.6070816491474Q 163.39393939393904 51.6070816491474 159.39393939393904 51.6070816491474L 4 51.6070816491474Q 0 51.6070816491474 0 47.6070816491474Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2681"><text id="SvgjsText2682" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="144px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.678540824573702" transform="rotate(0)"><tspan id="SvgjsTspan2683" dy="16.25" x="82"><tspan id="SvgjsTspan2684" style="font-style: italic;">node.predecessor()</tspan></tspan><tspan id="SvgjsTspan2685" dy="16.25" x="82"><tspan id="SvgjsTspan2686" style="">获取当前节点的前驱节点</tspan></tspan></text></g></g><g id="SvgjsG2687"><path id="SvgjsPath2688" d="M2626.5151515151515 2087.71867592661L2626.5151515151515 2111.96867592661L2626.5151515151515 2111.96867592661L2626.5151515151515 2134.2686759266103" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2689)"></path></g><g id="SvgjsG2691"><path id="SvgjsPath2692" d="M2675.2651515151515 2300.3249176734503L2765.6183712121215 2300.3249176734503L2765.6183712121215 2384.214807414811" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2693)"></path><rect id="SvgjsRect2695" width="29" height="16" x="2702.7817117426166" y="2292.3249176734503" fill="#ffffff"></rect><text id="SvgjsText2696" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2289.6999176734503" transform="rotate(0)"><tspan id="SvgjsTspan2697" dy="16.25" x="2717.2817117426166"><tspan id="SvgjsTspan2698" style="">false</tspan></tspan></text></g><g id="SvgjsG2699"><path id="SvgjsPath2700" d="M2896.916666666667 2418.290737040739L2926.166666666667 2418.290737040739L2926.166666666667 2061.1651351020364L2710.912121212121 2061.1651351020364" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2701)"></path><rect id="SvgjsRect2703" width="111" height="16" x="2870.666666666667" y="2268.5250139666355" fill="#ffffff"></rect><text id="SvgjsText2704" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="111px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2265.9000139666355" transform="rotate(0)"><tspan id="SvgjsTspan2705" dy="16.25" x="2926.166666666667"><tspan id="SvgjsTspan2706" style="">false 再次循环判断</tspan></tspan></text></g><g id="SvgjsG2707"><path id="SvgjsPath2708" d="M2577.7651515151515 2300.3249176734503L2420.2013888888896 2300.3249176734503L2420.2013888888896 2354.827317676849" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2709)"></path><rect id="SvgjsRect2711" width="24" height="16" x="2486.80725442957" y="2292.3249176734503" fill="#ffffff"></rect><text id="SvgjsText2712" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2289.6999176734503" transform="rotate(0)"><tspan id="SvgjsTspan2713" dy="16.25" x="2498.80725442957"><tspan id="SvgjsTspan2714" style="">true</tspan></tspan></text></g><g id="SvgjsG2715" transform="translate(2327.964330808081,2354.968857914159)"><path id="SvgjsPath2716" d="M 0 4Q 0 0 4 0L 180.47411616161708 0Q 184.47411616161708 0 184.47411616161708 4L 184.47411616161708 122.64375825315983Q 184.47411616161708 126.64375825315983 180.47411616161708 126.64375825315983L 4 126.64375825315983Q 0 126.64375825315983 0 122.64375825315983Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#e7fbd0"></path><g id="SvgjsG2717"><text id="SvgjsText2718" font-family="微软雅黑" text-anchor="start" font-size="13px" width="165px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.6968791265799155" transform="rotate(0)"><tspan id="SvgjsTspan2719" dy="16.25" x="10"><tspan id="SvgjsTspan2720" style="">表示获取到锁：</tspan></tspan><tspan id="SvgjsTspan2721" dy="16.25" x="10"><tspan id="SvgjsTspan2722" style="">1. node 设置为头节点</tspan></tspan><tspan id="SvgjsTspan2723" dy="16.25" x="10"><tspan id="SvgjsTspan2724" style="">2. 释放之前的头节点</tspan></tspan><tspan id="SvgjsTspan2725" dy="16.25" x="10"><tspan id="SvgjsTspan2726" style="">这个逻辑执行完之后，node </tspan></tspan><tspan id="SvgjsTspan2727" dy="16.25" x="10"><tspan id="SvgjsTspan2728" style="">节点就不会再排队了(获取到</tspan></tspan><tspan id="SvgjsTspan2729" dy="16.25" x="10"><tspan id="SvgjsTspan2730" style="">锁的线程，不会在排队队列</tspan></tspan><tspan id="SvgjsTspan2731" dy="16.25" x="10"><tspan id="SvgjsTspan2732" style="">中了)</tspan></tspan></text></g></g><g id="SvgjsG2733"><path id="SvgjsPath2734" d="M2634.320075757576 2418.290737040739L2583.181818181819 2418.290737040739L2583.181818181819 2508.898305401244" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2735)"></path></g><g id="SvgjsG2737" transform="translate(2500.6969696969704,2511.598305401244)"><path id="SvgjsPath2738" d="M 0 4Q 0 0 4 0L 160.96969696969654 0Q 164.96969696969654 0 164.96969696969654 4L 164.96969696969654 59.720718012784346Q 164.96969696969654 63.720718012784346 160.96969696969654 63.720718012784346L 4 63.720718012784346Q 0 63.720718012784346 0 59.720718012784346Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#f9f630"></path><g id="SvgjsG2739"><text id="SvgjsText2740" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="145px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="4.735359006392173" transform="rotate(0)"><tspan id="SvgjsTspan2741" dy="16.25" x="82.5"><tspan id="SvgjsTspan2742" style="font-style: italic;">parkAndCheckInterrupt(</tspan></tspan><tspan id="SvgjsTspan2743" dy="16.25" x="82.5"><tspan id="SvgjsTspan2744" style="font-style: italic;">)</tspan></tspan><tspan id="SvgjsTspan2745" dy="16.25" x="82.5"><tspan id="SvgjsTspan2746" style="">线程进入阻塞状态</tspan></tspan></text></g></g><g id="SvgjsG2747"><path id="SvgjsPath2748" d="M2499.9469696969704 2543.458664407636L2460.39393939394 2543.458664407636L2460.39393939394 2543.458664407636L2422.790909090909 2543.458664407636" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2749)"></path></g><g id="SvgjsG2751" transform="translate(2327.964330808081,2516.458664407636)"><path id="SvgjsPath2752" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2753"><text id="SvgjsText2754" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2755" dy="16.25" x="48"><tspan id="SvgjsTspan2756" style="">阻塞结束</tspan></tspan></text></g></g><g id="SvgjsG2757"><path id="SvgjsPath2758" d="M2327.214330808081 2543.458664407636L2297.964330808081 2543.458664407636L2297.964330808081 2214.390941553649L2415.1407624633434 2214.390941553649L2415.1407624633434 2061.1651351020364L2542.118181818182 2061.1651351020364" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2759)"></path><rect id="SvgjsRect2761" width="78" height="16" x="2258.964330808081" y="2293.427877411107" fill="#ffffff"></rect><text id="SvgjsText2762" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="78px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2290.802877411107" transform="rotate(0)"><tspan id="SvgjsTspan2763" dy="16.25" x="2297.964330808081"><tspan id="SvgjsTspan2764" style="">再次循环判断</tspan></tspan></text></g><g id="SvgjsG2765"><path id="SvgjsPath2766" d="M2765.787207350781 2450.3974158427063C 2774.504618276817 2522.0393412061185 2874.750485973434 2459.059585017519 2946.917669842516 2459.0983633286137" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2767" transform="translate(2947.666666666667,2329.96867592661)"><path id="SvgjsPath2768" d="M 0 0L 483.3333333333326 0L 483.3333333333326 258.181818181818L 0 258.181818181818Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2769"><text id="SvgjsText2770" font-family="微软雅黑" text-anchor="start" font-size="13px" width="464px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="4.465909090909008" transform="rotate(0)"><tspan id="SvgjsTspan2771" dy="16.25" x="10"><tspan id="SvgjsTspan2772" style="">private static boolean shouldParkAfterFailedAcquire(Node pred, </tspan></tspan><tspan id="SvgjsTspan2773" dy="16.25" x="10"><tspan id="SvgjsTspan2774" style="">Node node) {</tspan></tspan><tspan id="SvgjsTspan2775" dy="16.25" x="10"><tspan id="SvgjsTspan2776" style="">    int ws = pred.waitStatus;</tspan></tspan><tspan id="SvgjsTspan2777" dy="16.25" x="10"><tspan id="SvgjsTspan2778" style="">    if (ws == Node.SIGNAL)</tspan></tspan><tspan id="SvgjsTspan2779" dy="16.25" x="10"><tspan id="SvgjsTspan2780" style="">        return true;</tspan></tspan><tspan id="SvgjsTspan2781" dy="16.25" x="10"><tspan id="SvgjsTspan2782" style="">    if (ws &gt; 0) {</tspan></tspan><tspan id="SvgjsTspan2783" dy="16.25" x="10"><tspan id="SvgjsTspan2784" style="">        do {</tspan></tspan><tspan id="SvgjsTspan2785" dy="16.25" x="10"><tspan id="SvgjsTspan2786" style="">            node.prev = pred = pred.prev;</tspan></tspan><tspan id="SvgjsTspan2787" dy="16.25" x="10"><tspan id="SvgjsTspan2788" style="">        } while (pred.waitStatus &gt; 0);</tspan></tspan><tspan id="SvgjsTspan2789" dy="16.25" x="10"><tspan id="SvgjsTspan2790" style="">        pred.next = node;</tspan></tspan><tspan id="SvgjsTspan2791" dy="16.25" x="10"><tspan id="SvgjsTspan2792" style="">    } else {</tspan></tspan><tspan id="SvgjsTspan2793" dy="16.25" x="10"><tspan id="SvgjsTspan2794" style="">        compareAndSetWaitStatus(pred, ws, Node.SIGNAL);</tspan></tspan><tspan id="SvgjsTspan2795" dy="16.25" x="10"><tspan id="SvgjsTspan2796" style="">    }</tspan></tspan><tspan id="SvgjsTspan2797" dy="16.25" x="10"><tspan id="SvgjsTspan2798" style="">    return false;</tspan></tspan><tspan id="SvgjsTspan2799" dy="16.25" x="10"><tspan id="SvgjsTspan2800" style="">}</tspan></tspan></text></g></g><g id="SvgjsG2801"><path id="SvgjsPath2802" d="M3189.459370540882 2329.2293420221304C 3189.333333333333 2294.914137668455 3232.439393939394 2288.721204924822 3232.439393939394 2253.666666666667" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2803" transform="translate(3139.333333333333,2160.939393939394)"><path id="SvgjsPath2804" d="M 0 0L 170.21212121212147 0L 186.21212121212147 16L 186.21212121212147 92.72727272727298L 0 92.72727272727298L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2805" d="M 170.21212121212147 0L 170.21212121212147 16L 186.21212121212147 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2806" d="M 0 0L 170.21212121212147 0L 186.21212121212147 16L 186.21212121212147 92.72727272727298L 0 92.72727272727298L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2807"><text id="SvgjsText2808" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="167px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.238636363636488" transform="rotate(0)"><tspan id="SvgjsTspan2809" dy="16.25" x="93.5"><tspan id="SvgjsTspan2810" style="">这个方法，接收两个 </tspan><tspan id="SvgjsTspan2811" style="font-style: italic;">Node</tspan><tspan id="SvgjsTspan2812" style=""> </tspan></tspan><tspan id="SvgjsTspan2813" dy="16.25" x="93.5"><tspan id="SvgjsTspan2814" style="">对象参数：参数 2 是准备执</tspan></tspan><tspan id="SvgjsTspan2815" dy="16.25" x="93.5"><tspan id="SvgjsTspan2816" style="">行 </tspan><tspan id="SvgjsTspan2817" style="font-style: italic;">park</tspan><tspan id="SvgjsTspan2818" style=""> 操作的节点 </tspan><tspan id="SvgjsTspan2819" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2820" style="">，</tspan></tspan><tspan id="SvgjsTspan2821" dy="16.25" x="93.5"><tspan id="SvgjsTspan2822" style="">参数 1 是其前驱节点 </tspan><tspan id="SvgjsTspan2823" style="font-style: italic;">prev</tspan></tspan></text></g></g><g id="SvgjsG2824"><path id="SvgjsPath2825" d="M2583.006669866359 2576.048285416049C 2583.181818181819 2625.440254366448 2471.418560606061 2581.8532022405143 2471.5937089215213 2631.245171190913" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2826" transform="translate(2307.7670454545455,2631.9744331929337)"><path id="SvgjsPath2827" d="M 0 0L 327.3030303030305 0L 327.3030303030305 83.7552076459574L 0 83.7552076459574Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2828"><text id="SvgjsText2829" font-family="微软雅黑" text-anchor="start" font-size="13px" width="308px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="6.752603822978699" transform="rotate(0)"><tspan id="SvgjsTspan2830" dy="16.25" x="10"><tspan id="SvgjsTspan2831" style="">private final boolean parkAndCheckInterrupt() {</tspan></tspan><tspan id="SvgjsTspan2832" dy="16.25" x="10"><tspan id="SvgjsTspan2833" style="">    LockSupport.park(this);</tspan></tspan><tspan id="SvgjsTspan2834" dy="16.25" x="10"><tspan id="SvgjsTspan2835" style="">    return Thread.interrupted();</tspan></tspan><tspan id="SvgjsTspan2836" dy="16.25" x="10"><tspan id="SvgjsTspan2837" style="">}</tspan></tspan></text></g></g><g id="SvgjsG2838"><path id="SvgjsPath2839" d="M2471.0157895712346 2716.3623141301755C 2471.418560606061 2736.5314669036934 2426.5666417967523 2721.248532408919 2426.5666417967523 2742.050358473721" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2840" transform="translate(2264.1407828282836,2743.0448144246043)"><path id="SvgjsPath2841" d="M 0 0L 325.40467171717046 0L 341.40467171717046 16L 341.40467171717046 130.7654715755766L 0 130.7654715755766L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2842" d="M 325.40467171717046 0L 325.40467171717046 16L 341.40467171717046 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2843" d="M 0 0L 325.40467171717046 0L 341.40467171717046 16L 341.40467171717046 130.7654715755766L 0 130.7654715755766L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2844"><text id="SvgjsText2845" font-family="微软雅黑" text-anchor="start" font-size="13px" width="322px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.757735787788306" transform="rotate(0)"><tspan id="SvgjsTspan2846" dy="16.25" x="10"><tspan id="SvgjsTspan2847" style="">两种情况，会导致阻塞结束：</tspan></tspan><tspan id="SvgjsTspan2848" dy="16.25" x="10"><tspan id="SvgjsTspan2849" style="">1. 持有锁的线程，释放锁后，将这个线程 </tspan><tspan id="SvgjsTspan2850" style="font-style: italic;">unpark</tspan><tspan id="SvgjsTspan2851" style=""> 了。</tspan></tspan><tspan id="SvgjsTspan2852" dy="16.25" x="10"><tspan id="SvgjsTspan2853" style="">此时该线程，一定排在队列的队头(不包括 </tspan><tspan id="SvgjsTspan2854" style="font-style: italic;">head</tspan><tspan id="SvgjsTspan2855" style=""> 节点)；</tspan></tspan><tspan id="SvgjsTspan2856" dy="16.25" x="10"><tspan id="SvgjsTspan2857" style="">2. 线程被 </tspan><tspan id="SvgjsTspan2858" style="font-style: italic;">interrupt</tspan><tspan id="SvgjsTspan2859" style=""> 了。(注意，在外部 </tspan><tspan id="SvgjsTspan2860" style="font-style: italic;">interrupt</tspan><tspan id="SvgjsTspan2861" style=""> 这个</tspan></tspan><tspan id="SvgjsTspan2862" dy="16.25" x="10"><tspan id="SvgjsTspan2863" style="">线程，不是抛出 </tspan><tspan id="SvgjsTspan2864" style="font-style: italic;">InterruptException</tspan><tspan id="SvgjsTspan2865" style="">，这一点和 </tspan><tspan id="SvgjsTspan2866" style="font-style: italic;">sleep</tspan><tspan id="SvgjsTspan2867" style="">、</tspan></tspan><tspan id="SvgjsTspan2868" dy="16.25" x="10"><tspan id="SvgjsTspan2869" style="font-style: italic;">wait</tspan><tspan id="SvgjsTspan2870" style=""> 阻塞不一样)</tspan></tspan></text></g></g><g id="SvgjsG2871"><path id="SvgjsPath2872" d="M3189.2191310843764 2588.8917483470896C 3189.333333333333 2626.028787834382 3144.5055269816753 2630.3761228610156 3138.1617327804433 2666.9663009814876" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect2873" width="235" height="16" x="3045.72546453541" y="2622.6096039224403" fill="#ffffff"></rect><text id="SvgjsText2874" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2619.9846039224403" transform="rotate(0)"><tspan id="SvgjsTspan2875" dy="16.25" x="3163.22546453541"><tspan id="SvgjsTspan2876" style="">shouldParkAfterFailedAcquire 方法详解</tspan></tspan></text></g><g id="SvgjsG2877" transform="translate(3025.007575757576,2667.6789601932087)"><path id="SvgjsPath2878" d="M 0 24.025340322841203L 112.9204545454545 0L 225.840909090909 24.025340322841203L 112.9204545454545 48.050680645682405Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2879"><text id="SvgjsText2880" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="206px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.640593726069614" transform="rotate(0)"><tspan id="SvgjsTspan2881" dy="16.25" x="113"><tspan id="SvgjsTspan2882" style="font-style: italic;">pre.waitState == Node.SIGNAL</tspan></tspan></text></g></g><g id="SvgjsG2883"><path id="SvgjsPath2884" d="M3024.257575757576 2691.70430051605L2975.545454545454 2691.70430051605L2975.545454545454 2763.693939393939" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2885)"></path><rect id="SvgjsRect2887" width="24" height="16" x="2963.545454545454" y="2717.6893108057466" fill="#ffffff"></rect><text id="SvgjsText2888" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="24px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2715.0643108057466" transform="rotate(0)"><tspan id="SvgjsTspan2889" dy="16.25" x="2975.545454545454"><tspan id="SvgjsTspan2890" style="">true</tspan></tspan></text></g><g id="SvgjsG2891" transform="translate(2929.007575757576,2766.393939393939)"><path id="SvgjsPath2892" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2893"><text id="SvgjsText2894" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2895" dy="16.25" x="48"><tspan id="SvgjsTspan2896" style="">返回 </tspan><tspan id="SvgjsTspan2897" style="font-style: italic;">true</tspan></tspan></text></g></g><g id="SvgjsG2898"><path id="SvgjsPath2899" d="M3251.598484848485 2691.70430051605L3279.9393939393935 2691.70430051605L3279.9393939393935 2768.421212121212" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2900)"></path><rect id="SvgjsRect2902" width="29" height="16" x="3265.4393939393935" y="2720.6367861524805" fill="#ffffff"></rect><text id="SvgjsText2903" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2718.0117861524805" transform="rotate(0)"><tspan id="SvgjsTspan2904" dy="16.25" x="3279.9393939393935"><tspan id="SvgjsTspan2905" style="">false</tspan></tspan></text></g><g id="SvgjsG2906" transform="translate(3214.575757575757,2771.121212121212)"><path id="SvgjsPath2907" d="M 0 22.272727272727252L 65.36363636363626 0L 130.72727272727252 22.272727272727252L 65.36363636363626 44.545454545454504Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2908"><text id="SvgjsText2909" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="111px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="11.870454545454525" transform="rotate(0)"><tspan id="SvgjsTspan2910" dy="16.25" x="65.5"><tspan id="SvgjsTspan2911" style="">pre.waitState &gt; 0</tspan></tspan></text></g></g><g id="SvgjsG2912"><path id="SvgjsPath2913" d="M3213.825757575757 2793.393939393939L3082.7272727272725 2793.393939393939L3082.7272727272725 2858.753306595147" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2914)"></path></g><g id="SvgjsG2916" transform="translate(2958.272727272727,2861.453306595147)"><path id="SvgjsPath2917" d="M 0 4Q 0 0 4 0L 244.909090909091 0Q 248.909090909091 0 248.909090909091 4L 248.909090909091 84.03073866292561Q 248.909090909091 88.03073866292561 244.909090909091 88.03073866292561L 4 88.03073866292561Q 0 88.03073866292561 0 84.03073866292561Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2918"><text id="SvgjsText2919" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="229px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.890369331462807" transform="rotate(0)"><tspan id="SvgjsTspan2920" dy="16.25" x="124.5"><tspan id="SvgjsTspan2921" style="font-style: italic;">&gt; 0</tspan><tspan id="SvgjsTspan2922" style="">；只能 </tspan><tspan id="SvgjsTspan2923" style="font-style: italic;">== 1</tspan><tspan id="SvgjsTspan2924" style="">；</tspan></tspan><tspan id="SvgjsTspan2925" dy="16.25" x="124.5"><tspan id="SvgjsTspan2926" style="">即 </tspan><tspan id="SvgjsTspan2927" style="font-style: italic;">CANCELED</tspan><tspan id="SvgjsTspan2928" style="">。表示 </tspan><tspan id="SvgjsTspan2929" style="font-style: italic;">node</tspan><tspan id="SvgjsTspan2930" style=""> 的前驱节</tspan></tspan><tspan id="SvgjsTspan2931" dy="16.25" x="124.5"><tspan id="SvgjsTspan2932" style="">点，已经取消了，此时将链表关系重新</tspan></tspan><tspan id="SvgjsTspan2933" dy="16.25" x="124.5"><tspan id="SvgjsTspan2934" style="">维护下：即将其前驱节点从队列移出。</tspan></tspan></text></g></g><g id="SvgjsG2935"><path id="SvgjsPath2936" d="M3346.0530303030296 2793.393939393939L3412.0123966942147 2793.393939393939L3412.0123966942147 2873.951297335204" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2937)"></path></g><g id="SvgjsG2939" transform="translate(3325.5454545454545,2878.4686759266096)"><path id="SvgjsPath2940" d="M 0 4Q 0 0 4 0L 165.090909090909 0Q 169.090909090909 0 169.090909090909 4L 169.090909090909 50Q 169.090909090909 54 165.090909090909 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2941"><text id="SvgjsText2942" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="150px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2943" dy="16.25" x="85"><tspan id="SvgjsTspan2944" style="">设置 </tspan><tspan id="SvgjsTspan2945" style="font-style: italic;">pred.waitState = -1</tspan></tspan></text></g></g><g id="SvgjsG2946"><path id="SvgjsPath2947" d="M3082.7272727272725 2950.2340452580725L3082.7272727272725 2972.1196354461426L3277.5454545454545 2972.1196354461426L3277.5454545454545 2992.0552256342125" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2948)"></path></g><g id="SvgjsG2950" transform="translate(3229.5454545454545,2994.7552256342124)"><path id="SvgjsPath2951" d="M 0 4Q 0 0 4 0L 92 0Q 96 0 96 4L 96 50Q 96 54 92 54L 4 54Q 0 54 0 50Z" stroke="rgba(33,41,48,1)" stroke-width="1.5" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2952"><text id="SvgjsText2953" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="76px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="italic" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan2954" dy="16.25" x="48"><tspan id="SvgjsTspan2955" style="">返回 false</tspan></tspan></text></g></g><g id="SvgjsG2956"><path id="SvgjsPath2957" d="M3410.090909090909 2933.2186759266096L3410.090909090909 2971.793768962229L3277.5454545454545 2971.793768962229L3277.5454545454545 2992.0552256342125" stroke="#323232" stroke-width="1.5" fill="none" marker-end="url(#SvgjsMarker2958)"></path></g><g id="SvgjsG2960"><path id="SvgjsPath2961" d="M3495.3794089563203 2905.36677571812C 3547.0618493088373 2905.4686759266096 3533.7272727272725 2832.7958082869254 3533.7272727272725 2780.3703226144517" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path></g><g id="SvgjsG2962" transform="translate(3388.272727272727,2601.1640236050644)"><path id="SvgjsPath2963" d="M 0 0L 274.909090909091 0L 290.909090909091 16L 290.909090909091 181.08055382197108L 0 181.08055382197108L 0 0Z" stroke="none" fill-opacity="1" fill="#fff7bc"></path><path id="SvgjsPath2964" d="M 274.909090909091 0L 274.909090909091 16L 290.909090909091 16Z" stroke="none" fill-opacity="1" fill="#e4d089"></path><path id="SvgjsPath2965" d="M 0 0L 274.909090909091 0L 290.909090909091 16L 290.909090909091 181.08055382197108L 0 181.08055382197108L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG2966"><text id="SvgjsText2967" font-family="微软雅黑" text-anchor="start" font-size="13px" width="271px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.5847230890144601" transform="rotate(0)"><tspan id="SvgjsTspan2968" dy="16.25" x="10"><tspan id="SvgjsTspan2969" style="">注意，这里是设置 pred 节点，而不是 node 节</tspan></tspan><tspan id="SvgjsTspan2970" dy="16.25" x="10"><tspan id="SvgjsTspan2971" style="">点的 waitState。-1 表示节点处于阻塞状态</tspan></tspan><tspan id="SvgjsTspan2972" dy="16.25" x="10"><tspan id="SvgjsTspan2973" style="">了。</tspan></tspan><tspan id="SvgjsTspan2974" dy="16.25" x="10"><tspan id="SvgjsTspan2975" style=""> </tspan></tspan><tspan id="SvgjsTspan2976" dy="16.25" x="10"><tspan id="SvgjsTspan2977" style="">为何每个线程进入该方法后，修改的是上一个</tspan></tspan><tspan id="SvgjsTspan2978" dy="16.25" x="10"><tspan id="SvgjsTspan2979" style="">节点的 waitState，而不是修改自己的？</tspan></tspan><tspan id="SvgjsTspan2980" dy="16.25" x="10"><tspan id="SvgjsTspan2981" style=""> </tspan></tspan><tspan id="SvgjsTspan2982" dy="16.25" x="10"><tspan id="SvgjsTspan2983" style="">因为线程调用 park 后，无法设置自己的这个状</tspan></tspan><tspan id="SvgjsTspan2984" dy="16.25" x="10"><tspan id="SvgjsTspan2985" style="">态，若在调用 park 前设置，存在不一致问题。</tspan></tspan><tspan id="SvgjsTspan2986" dy="16.25" x="10"><tspan id="SvgjsTspan2987" style="">所以，每个 node 的 waitState，在后继节点加</tspan></tspan><tspan id="SvgjsTspan2988" dy="16.25" x="10"><tspan id="SvgjsTspan2989" style="">入时设置。</tspan></tspan></text></g></g><g id="SvgjsG2990"><path id="SvgjsPath2991" d="M2373.6412438963853 1584.4163643046966C 2373.6199494949497 1790.73546328621 2626.5151515151515 1828.2927976579192 2626.493857113716 2034.6118966394326" stroke-dasharray="8,5" stroke="#323232" stroke-width="1.5" fill="none"></path><rect id="SvgjsRect2992" width="147" height="16" x="2348.505270698653" y="1717.4409569263707" fill="#ffffff"></rect><text id="SvgjsText2993" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="147px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1714.8159569263707" transform="rotate(0)"><tspan id="SvgjsTspan2994" dy="16.25" x="2422.005270698653"><tspan id="SvgjsTspan2995" style="">acquireQueued 方法详解</tspan></tspan></text></g></svg>