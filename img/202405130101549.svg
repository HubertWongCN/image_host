<svg id="SvgjsSvg1155" width="1140" height="640" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1156"><pattern patternUnits="userSpaceOnUse" id="pattern_mark_0" width="300" height="300"><text x="150" y="100" fill="rgba(229,229,229,0.8)" font-size="18" transform="rotate(-45, 150, 150)" style="dominant-baseline: middle; text-anchor: middle;"></text></pattern><pattern patternUnits="userSpaceOnUse" id="pattern_mark_1" width="300" height="300"><text x="150" y="200" fill="rgba(229,229,229,0.8)" font-size="18" transform="rotate(-45, 150, 150)" style="dominant-baseline: middle; text-anchor: middle;"></text></pattern></defs><rect id="svgbackgroundid" width="1140" height="640" fill="transparent"></rect><rect id="SvgjsRect1158" width="1140" height="640" fill="url(#pattern_mark_0)"></rect><rect id="SvgjsRect1159" width="1140" height="640" fill="url(#pattern_mark_1)"></rect><g id="SvgjsG1160" transform="translate(25,25)"><path id="SvgjsPath1161" d="M0 0L545 0L545 31.506 L0 31.506Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1162" d="M545 0L1090 0L1090 31.506 L545 31.506Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1163" d="M0 31.506L545 31.506L545 90.506 L0 90.506Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1164" d="M545 31.506L1090 31.506L1090 90.506 L545 90.506Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1165" d="M0 90.506L545 90.506L545 235.174 L0 235.174Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1166" d="M545 90.506L1090 90.506L1090 235.174 L545 235.174Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1167" d="M0 235.174L545 235.174L545 425.68500000000006 L0 425.68500000000006Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1168" d="M545 235.174L1090 235.174L1090 425.68500000000006 L545 425.68500000000006Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1169" d="M0 425.685L545 425.685L545 526.3389999999999 L0 526.3389999999999Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1170" d="M545 425.685L1090 425.685L1090 526.3389999999999 L545 526.3389999999999Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1171" d="M0 526.339L545 526.339L545 590 L0 590Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1172" d="M545 526.339L1090 526.339L1090 590 L545 590Z" stroke="rgba(183,191,174,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1173"><text id="SvgjsText1174" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="-2.625" transform="rotate(0)"><tspan id="SvgjsTspan1175" dy="16.25" x="0"><tspan id="SvgjsTspan1176" style="">session_1</tspan></tspan></text></g><g id="SvgjsG1177"><text id="SvgjsText1178" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="-2.625" transform="rotate(0)"><tspan id="SvgjsTspan1179" dy="16.25" x="545"><tspan id="SvgjsTspan1180" style="">session_2</tspan></tspan></text></g><g id="SvgjsG1181"><text id="SvgjsText1182" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="28.881" transform="rotate(0)"><tspan id="SvgjsTspan1183" dy="16.25" x="0"><tspan id="SvgjsTspan1184" style="">获得表 mylock 的 READ 锁定</tspan></tspan><tspan id="SvgjsTspan1185" dy="16.25" x="0"><tspan id="SvgjsTspan1186" style="">mysql&gt; LOCK TABLE mylock READ;</tspan></tspan><tspan id="SvgjsTspan1187" dy="16.25" x="0"><tspan id="SvgjsTspan1188" style="">Query OK, 0 rows affected (0.01 sec)</tspan></tspan></text></g><g id="SvgjsG1189"><text id="SvgjsText1190" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="28.881" transform="rotate(0)"><tspan id="SvgjsTspan1191" dy="16.25" x="545"><tspan id="SvgjsTspan1192" style="">连接终端</tspan></tspan></text></g><g id="SvgjsG1193"><text id="SvgjsText1194" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="87.881" transform="rotate(0)"><tspan id="SvgjsTspan1195" dy="16.25" x="0"><tspan id="SvgjsTspan1196" style="">当前 session 可以查询该表记录</tspan></tspan><tspan id="SvgjsTspan1197" dy="16.25" x="0"><tspan id="SvgjsTspan1198" style="">mysql&gt; SELECT * FROM mylock;</tspan></tspan><tspan id="SvgjsTspan1199" dy="16.25" x="0"><tspan id="SvgjsTspan1200" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1201" dy="16.25" x="0"><tspan id="SvgjsTspan1202" style="">| id | name |</tspan></tspan><tspan id="SvgjsTspan1203" dy="16.25" x="0"><tspan id="SvgjsTspan1204" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1205" dy="16.25" x="0"><tspan id="SvgjsTspan1206" style="">|  1   | s     |</tspan></tspan><tspan id="SvgjsTspan1207" dy="16.25" x="0"><tspan id="SvgjsTspan1208" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1209" dy="16.25" x="0"><tspan id="SvgjsTspan1210" style="">1 row in set (0.00 sec)</tspan></tspan></text></g><g id="SvgjsG1211"><text id="SvgjsText1212" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="87.881" transform="rotate(0)"><tspan id="SvgjsTspan1213" dy="16.25" x="545"><tspan id="SvgjsTspan1214" style="">其它 session 也可以查询该表的记录</tspan></tspan><tspan id="SvgjsTspan1215" dy="16.25" x="545"><tspan id="SvgjsTspan1216" style="">mysql&gt; SELECT * FROM mylock;</tspan></tspan><tspan id="SvgjsTspan1217" dy="16.25" x="545"><tspan id="SvgjsTspan1218" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1219" dy="16.25" x="545"><tspan id="SvgjsTspan1220" style="">| id | name |</tspan></tspan><tspan id="SvgjsTspan1221" dy="16.25" x="545"><tspan id="SvgjsTspan1222" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1223" dy="16.25" x="545"><tspan id="SvgjsTspan1224" style="">|  1 | s    |</tspan></tspan><tspan id="SvgjsTspan1225" dy="16.25" x="545"><tspan id="SvgjsTspan1226" style="">+----+------+</tspan></tspan><tspan id="SvgjsTspan1227" dy="16.25" x="545"><tspan id="SvgjsTspan1228" style="">1 row in set (0.01 sec)</tspan></tspan></text></g><g id="SvgjsG1229"><text id="SvgjsText1230" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="232.549" transform="rotate(0)"><tspan id="SvgjsTspan1231" dy="16.25" x="0"><tspan id="SvgjsTspan1232" style="">当前 session 不能查询其它没有锁定的表</tspan></tspan><tspan id="SvgjsTspan1233" dy="16.25" x="0"><tspan id="SvgjsTspan1234" style="">mysql&gt; SELECT * FROM user1;</tspan></tspan><tspan id="SvgjsTspan1235" dy="16.25" x="0"><tspan id="SvgjsTspan1236" style="">ERROR 1100 (HY000): Table 'user1' was not locked with LOCK TABLES</tspan></tspan></text></g><g id="SvgjsG1237"><text id="SvgjsText1238" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="232.549" transform="rotate(0)"><tspan id="SvgjsTspan1239" dy="16.25" x="545"><tspan id="SvgjsTspan1240" style="">其它 session 可以查询或者更新未锁定的表</tspan></tspan><tspan id="SvgjsTspan1241" dy="16.25" x="545"><tspan id="SvgjsTspan1242" style="">mysql&gt; INSERT INTO user1(id, name, age, sex) VALUES(1002, '张三', 18, 'male');</tspan></tspan><tspan id="SvgjsTspan1243" dy="16.25" x="545"><tspan id="SvgjsTspan1244" style="">Query OK, 1 row affected (0.01 sec)</tspan></tspan><tspan id="SvgjsTspan1245" dy="16.25" x="545"><tspan id="SvgjsTspan1246" style=""> </tspan></tspan><tspan id="SvgjsTspan1247" dy="16.25" x="545"><tspan id="SvgjsTspan1248" style="">mysql&gt; SELECT * FROM user1 WHERE id = 1002;</tspan></tspan><tspan id="SvgjsTspan1249" dy="16.25" x="545"><tspan id="SvgjsTspan1250" style="">+------+--------+------+------+</tspan></tspan><tspan id="SvgjsTspan1251" dy="16.25" x="545"><tspan id="SvgjsTspan1252" style="">| id   | name   | age  | sex  |</tspan></tspan><tspan id="SvgjsTspan1253" dy="16.25" x="545"><tspan id="SvgjsTspan1254" style="">+------+--------+------+------+</tspan></tspan><tspan id="SvgjsTspan1255" dy="16.25" x="545"><tspan id="SvgjsTspan1256" style="">| 1002 | 张三   |   18 | male |</tspan></tspan><tspan id="SvgjsTspan1257" dy="16.25" x="545"><tspan id="SvgjsTspan1258" style="">+------+--------+------+------+</tspan></tspan><tspan id="SvgjsTspan1259" dy="16.25" x="545"><tspan id="SvgjsTspan1260" style="">1 row in set (0.01 sec)</tspan></tspan></text></g><g id="SvgjsG1261"><text id="SvgjsText1262" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="423.06" transform="rotate(0)"><tspan id="SvgjsTspan1263" dy="16.25" x="0"><tspan id="SvgjsTspan1264" style="">当前 session 中插入或更新锁定的表都会提示错误：</tspan></tspan><tspan id="SvgjsTspan1265" dy="16.25" x="0"><tspan id="SvgjsTspan1266" style="">mysql&gt; INSERT INTO mylock(name) VALUES('e');</tspan></tspan><tspan id="SvgjsTspan1267" dy="16.25" x="0"><tspan id="SvgjsTspan1268" style="">ERROR 1099 (HY000): Table 'mylock' was locked with a READ lock and can't be updated</tspan></tspan><tspan id="SvgjsTspan1269" dy="16.25" x="0"><tspan id="SvgjsTspan1270" style="">mysql&gt; UPDATE mylock SET name = 'k' WHERE id = 1;</tspan></tspan><tspan id="SvgjsTspan1271" dy="16.25" x="0"><tspan id="SvgjsTspan1272" style="">ERROR 1099 (HY000): Table 'mylock' was locked with a READ lock and can't be updated</tspan></tspan></text></g><g id="SvgjsG1273"><text id="SvgjsText1274" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="423.06" transform="rotate(0)"><tspan id="SvgjsTspan1275" dy="16.25" x="545"><tspan id="SvgjsTspan1276" style="">其它 session 插入或更新锁定表会一直等待获得锁：</tspan></tspan><tspan id="SvgjsTspan1277" dy="16.25" x="545"><tspan id="SvgjsTspan1278" style="">mysql&gt; INSERT INTO mylock(name) VALUES('e');</tspan></tspan><tspan id="SvgjsTspan1279" dy="16.25" x="545"><tspan id="SvgjsTspan1280" style=""> </tspan></tspan></text></g><g id="SvgjsG1281"><text id="SvgjsText1282" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="523.714" transform="rotate(0)"><tspan id="SvgjsTspan1283" dy="16.25" x="0"><tspan id="SvgjsTspan1284" style="">释放锁</tspan></tspan><tspan id="SvgjsTspan1285" dy="16.25" x="0"><tspan id="SvgjsTspan1286" style="">mysql&gt; UNLOCK TABLES ;</tspan></tspan><tspan id="SvgjsTspan1287" dy="16.25" x="0"><tspan id="SvgjsTspan1288" style="">Query OK, 0 rows affected (0.01 sec)</tspan></tspan></text></g><g id="SvgjsG1289"><text id="SvgjsText1290" font-family="&quot;Comic Sans MS&quot;" text-anchor="start" font-size="13px" width="545px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="&quot;Comic Sans MS&quot;" size="13px" weight="400" font-style="" opacity="1" y="523.714" transform="rotate(0)"><tspan id="SvgjsTspan1291" dy="16.25" x="545"><tspan id="SvgjsTspan1292" style="">session_2获得锁，插入操作完成：</tspan></tspan><tspan id="SvgjsTspan1293" dy="16.25" x="545"><tspan id="SvgjsTspan1294" style="">mysql&gt; INSERT INTO mylock(name) VALUES('e');</tspan></tspan><tspan id="SvgjsTspan1295" dy="16.25" x="545"><tspan id="SvgjsTspan1296" style="">Query OK, 1 row affected (26.03 sec)</tspan></tspan></text></g></g><g id="SvgjsG1297"></g></svg>